<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="description" content="The complete guide to building a faucet CLI using NodeJS."> <meta name="twitter:description" content="The complete guide to building a faucet CLI using NodeJS."> <meta property="og:description" content="The complete guide to building a faucet CLI using NodeJS."> <meta property="og:title" content="How to build a faucet CLI using NodeJS 🚀"> <meta property="og:image" content="https://imgur.com/0qQxUt3.png"> <meta property="og:image:alt" content="How to build a faucet CLI using NodeJS 🚀"> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="@genicsblog"> <meta name="twitter:image" content="https://imgur.com/0qQxUt3.png"> <meta name="twitter:creator" content="@kira_272921"> <meta property="og:type" content="article"> <meta property="article:section" content="web3"> <meta property="article:tag" content="blockchain, node-js, cli"> <meta property="article:author" content="https://genicsblog.com/author/kira/"> <meta property="article:published_time" content="2022-04-24T00:00:00+0000"> <meta property="og:url" content="https://genicsblog.com/kira/how-to-build-a-faucet-cli-using-node-js"> <meta name="theme-color" content="#16161f"> <meta name="msapplication-TileColor" content="#16161f"> <meta name="msapplication-navbutton-color" content="#16161f"> <meta name="apple-mobile-web-app-status-bar-style" content="#16161f"> <link rel="canonical" href="https://blog.kiradev.co/how-to-build-a-faucet-cli-using-nodejs"> <link rel="preconnect" href="https://fonts.googleapis.com"> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> <link href="https://fonts.googleapis.com/css2?family=Fira+Code&amp;family=Sen&amp;display=swap" rel="stylesheet"> <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon"> <link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png"> <link rel="stylesheet" href="/assets/css/theme.css"> <link rel="stylesheet" href="/assets/css/prism.css"> <link rel="manifest" href="/manifest.json"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-KQJM9Z9N1Z"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KQJM9Z9N1Z");</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8114751086331659" crossorigin="anonymous"></script> <title>How to build a faucet CLI using NodeJS 🚀</title> </head> <body> <nav> <p class="bg-primary p-3 text-center text-white font-medium flex flex-col sm:block"> <span class="md:hidden px-1">Connect with us on discord to stay updated.</span> <span class="hidden md:inline px-1">Connect with us on discord to stay updated on the blog's development.</span> <a href="https://discord.genicsblog.com" target="_blank" class="font-bold underline header-anchor hover:text-slate-300" rel="nofollow noopener noreferrer"> Join &gt; </a> </p> <header class="w-full top-0 z-10" id="navbar"> <div class="bg-background max-h-20 py-1 px-2 sm:px-8 lg:px-8 mx-auto"> <div class="flex justify-between h-16"> <div class="flex px-2 lg:px-0"> <a class="group flex-shrink-0 flex items-center logo-anchor" href="/" aria-label="Home Page Link"> <div class="flex items-center space-x-2 whitespace-nowrap flex-nowrap"> <div class="h-8 w-8 mx-2"> <svg class="h-8 w-8 fill-white group-hover:fill-slate-300" viewbox="0 0 79.784508 91.197495" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2"></defs> <g id="layer1" transform="translate(-68.235445,-52.679805)"> <path id="path962" style=" stroke: none; stroke-width: 0.999999px; stroke-linecap: butt; stroke-linejoin: miter; stroke-opacity: 1; " d="m 408.73047,210.44336 -139.49414,80.59961 0.87109,162.49414 52.71289,-32.94922 85.34766,48.85938 87.42773,-48.85743 -0.63476,-53.22851 -84.8711,-0.88477 v 27.79297 h 56.02735 v 9.45508 l -58.31446,33.66797 -56.13085,-32.4082 0.63476,-66.94922 55.81836,-32.22461 57.25195,32.76172 82.41016,-47.75782 z m 0.43945,32.62695 83.28125,48.08203 -26.93555,15.55274 -57.21484,-33.0332 -84.18359,48.60351 v 66.39453 l -25.48047,14.71094 0.084,-96.54102 z" transform="scale(0.26458333)"></path> <path style=" stroke: none; stroke-width: 0.264583px; stroke-linecap: butt; stroke-linejoin: miter; stroke-opacity: 1; " d="m 81.889144,125.74786 26.204966,15.12944 36.92584,-21.31914 V 88.998204 l -7.22758,4.172845 V 115.03627 L 108.1902,132.12709 89.310794,121.22706 Z" id="path1416"></path> </g> </svg> </div> <span class="font-bold hidden sm:block text-xl tracking-tight text-white group-hover:text-slate-300"> Genics Blog</span> </div> </a> </div> <div class="flex items-center h-16"> <div class="hidden lg:block"> <a class="nav-item text-white" href="/topics">Topics</a> <a class="nav-item text-white" href="/about">About Us</a> <a class="nav-item text-white" href="/contact">Contact</a> <a class="nav-item text-white" target="_blank" href="https://docs.genicsblog.com">Docs</a> </div> <button onclick="showSearch()" aria-label="Search across the site..."> <svg xmlns="http://www.w3.org/2000/svg" class="ml-4 h-6 w-6 stroke-white hover:stroke-slate-300" fill="none" viewbox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path> </svg> </button> <button type="button" class="ml-2" onclick="saveTheme(isDark() ? LIGHT : DARK)" title="Ctrl + Shift + L"> <svg viewbox="0 0 512 512" class="h-8 w-8 fill-white hover:fill-slate-300 transition-all" id="theme-toggle-icon"> <g> <path d="M262.524,164.624c-49.466,0-89.592,40.119-89.592,89.596c0,49.487,40.126,89.606,89.592,89.606 c49.487,0,89.613-40.119,89.613-89.606C352.138,204.743,312.012,164.624,262.524,164.624z M262.524,320.136 c-36.39,0-65.902-29.513-65.902-65.916c0-36.396,29.513-65.903,65.902-65.903c36.41,0,65.924,29.506,65.924,65.903 C328.448,290.623,298.935,320.136,262.524,320.136z"></path> <path d="M264.078,149.221c0,0-39.031-73.758,0-73.758C303.103,75.462,264.078,149.221,264.078,149.221z"></path> <path d="M261.922,363.328c0,0,39.053,73.737,0,73.737C222.905,437.045,261.922,363.328,261.922,363.328z"></path> <path d="M186.536,331.194c0,0-24.539,79.766-52.142,52.148C106.817,355.746,186.536,331.194,186.536,331.194z"></path> <path d="M155.941,255.181c0,0-73.745,39.048-73.745,0C82.224,216.177,155.941,255.181,155.941,255.181z"></path> <path d="M188.068,179.794c0,0-79.746-24.524-52.142-52.142C163.503,100.086,188.068,179.794,188.068,179.794z"></path> <path d="M428.852,254.552c0,49.668-40.276,89.931-89.935,89.931c-49.657,0-89.928-40.263-89.928-89.931 c0-49.672,40.271-89.928,89.928-89.928C388.575,164.624,428.852,204.88,428.852,254.552z"></path> </g> </svg> </button> <a class="ml-4 px-2.5 py-1.5 font-bold rounded-md text-black bg-white hover:bg-slate-300 hover:scale-110 transition underline-none" href="/contribute">Contribute</a> <div class="ml-4 lg:hidden cursor-pointer"> <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 stroke-white hover:stroke-slate-300" id="menu-open" viewbox="0 0 24 24" onclick="toggleNav()"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h16M4 16h16"></path> </svg> <svg xmlns="http://www.w3.org/2000/svg" class="menu-close h-8 w-8 hidden stroke-white hover:stroke-slate-300" id="menu-close" viewbox="0 0 24 24" onclick="toggleNav()"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path> </svg> </div> </div> </div> </div> <div class="top-0 bg-background hidden p-6 lg:hidden" id="mobile-nav"> <div class="grid grid-cols-2 gap-y-2 gap-x-4"> <a class="group mobile-nav-item " href="/topics"> <span class="group-hover:text-white">Topics</span> </a> <a class="group mobile-nav-item " href="/about"> <span class="group-hover:text-white">About Us</span> </a> <a class="group mobile-nav-item " href="/contact"> <span class="group-hover:text-white">Contact</span> </a> <a class="group mobile-nav-item" href="https://docs.genicsblog.com" target="_blank"> <span class="group-hover:text-white">Documentation</span> </a> </div> </div> </header> </nav> <header class="banner"> <div class="flex flex-col lg:flex-row p-2"> <div class="flex justify-center items-center lg:w-1/2 md:mb-0"> <img src="https://ik.imagekit.io/genicsblog/tr:w-1920,h-1080,f-webp/https://imgur.com/0qQxUt3.png" class="w-full md:w-3/4 lg:w-full rounded-xl shadow-xl aspect-video m-8" loading="lazy"> </div> <div class="flex flex-col justify-center lg:items-start w-full lg:w-1/2 lg:ml-12"> <h1 class="text-4xl font-black tracking-tight">How to build a faucet CLI using NodeJS 🚀</h1> <span class="mt-0.5 text-justify">The complete guide to building a faucet CLI using NodeJS.</span> <div class="flex items-center mt-8"> <img class="rounded-full w-14 h-14" src="https://ik.imagekit.io/genicsblog/tr:w-128,h-128,f-webp/https://avatars.githubusercontent.com/u/90365542?v=4" loading="lazy"> <div class="ml-4 leading-3"> <a class="font-extrabold text-xl" href="/author/kira/"> Kira </a> <br> <span class="text-sm"> Posted on April 24, 2022 </span> </div> </div> <div class="mt-8"> <span>Category: </span> <a class="text-sm ml-2 archive-name !bg-web3 underline-none" href="/category/web3">#web3</a> </div> <div class="mt-4 sm:mt-3"> <span>Tags: </span> <a class="text-sm ml-2 my-0.5 archive-name !bg-blockchain underline-none" href="/tag/blockchain">#blockchain</a> <a class="text-sm ml-2 my-0.5 archive-name !bg-node-js underline-none" href="/tag/node-js">#node-js</a> <a class="text-sm ml-2 my-0.5 archive-name !bg-cli underline-none" href="/tag/cli">#cli</a> </div> </div> </div> </header> <main> <section class="lg:flex"> <div class="md:text-lg m-6 md:m-10 lg:m-14 lg:w-full lg:max-w-[65%] xl:max-w-[70%]"> <div class="elevated"> <div class="notice w-full px-4 py-2 rounded-tl-2xl rounded-tr-2xl bg-slate-200 dark:bg-slate-800 space-y-4"> <span class="text-base italic leading-8"> Originally published at <a href="https://blog.kiradev.co/how-to-build-a-faucet-cli-using-nodejs" target="_blank" rel="nofollow noopener noreferrer">blog.kiradev.co</a>. </span> </div> <article class="p-6 md:p-8"> <div class="mb-6" id="audio-player" data-audio-id="4050344"></div> <p>Hey everyone 👋! I guess I took a long break from blogging but I am back with some interesting web3 stuff. Today we are doing to be BUIDLing a command-line interface that would act as a faucet and we would be also adding metamask authentication to it 🚀!</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://c.tenor.com/oR5fQW3UW78AAAAC/gm-web3.gif" alt="https://c.tenor.com/oR5fQW3UW78AAAAC/gm-web3.gif" loading="lazy"></p> <h1 id="-the-idea">💡 The idea</h1> <p>Let’s understand the idea of the command-line interface which we are going to be building. It’s a simple command-line interface that would transfer testnet tokens to the user and we are going to be adding metamask authentication also 👀.</p> <p>Wait what? Metamask authentication via a CLI ???</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://c.tenor.com/awhlFQC8WcAAAAAM/kid-what.gif" alt="https://c.tenor.com/awhlFQC8WcAAAAAM/kid-what.gif" loading="lazy"></p> <p>Let me explain how are we going to implement the Metamask authentication.</p> <ul> <li>We would create a basic website using Next.js which would have the connect with wallet (Metamask authentication) button. We would be using thirdweb to add Metamask authentication to our Next.js website.</li> <li>After the user has authenticated themselves via Metamask on the website, they would be redirected to a page with route <code class="language-plaintext highlighter-rouge">/callback</code>. When redirected the page would also contain a query parameter that contains the user’s wallet address 👀. So the user would be redirected to a page with route path something like this: <code class="language-plaintext highlighter-rouge">/callback?address=0xd24CA0297558f0827e2C467603869D1AC9fF435d</code>.</li> <li>We would be starting up a local express application at port <code class="language-plaintext highlighter-rouge">9991</code> (don’t worry we would be immediately closing the port after the authentication process is been completed). The <code class="language-plaintext highlighter-rouge">/callback</code> route exists on this local express application.</li> <li>👀 We don’t want the user to be seeing a blank page for hours right? (in context to make the user stay on the <code class="language-plaintext highlighter-rouge">/callback</code> route on the local express application) Instead, we can redirect them to a <code class="language-plaintext highlighter-rouge">/done</code> route on the main website, so that they will know that the authentication process is being completed.</li> </ul> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/OeXrCG0.png" alt="Authentication workflow" loading="lazy"></p> <p>😵‍💫 Woah! That’s hard to digest in one go</p> <h1 id="️-tech-stack">⚒️ Tech stack</h1> <p>The tech stack which we are going to be using to build this CLI:</p> <ul> <li>TypeScript as the main programming language that we are going to be using to program the command-line interface, website, and the backend</li> <li>Next.js as the framework that we are going to be using to build the website</li> <li>Tailwind CSS as our CSS framework to style the website</li> <li>Express as the backend framework</li> <li>Oclif as our command-line interface framework</li> <li>Thirdweb for the metamask authentication</li> <li>Web3.js and Ethers to perform tasks such as sending the testnet token to the user</li> <li>Alchemy as our blockchain node service</li> </ul> <h1 id="️-building-the-website">🛠️ Building the website</h1> <h2 id="️-creating-a-new-nextjs-project">🏗️ Creating a new Next.js project</h2> <p>Let’s create a new Next.js project by using the following command:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx create-next-app <span class="nt">-e</span><span class="o">=</span>with-tailwindcss thw-faucet-cli
</code></pre></div></div> <p>I am using <code class="language-plaintext highlighter-rouge">thw-faucet-cli</code> as my CLI name. Feel free to change the name of the CLI.</p> <p>This should generate a folder structure similar to this:</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/7wf52Gk.png" alt="Folder structure of the generated Next.js project" loading="lazy"></p> <h2 id="-adding-metamask-authentication-using-thirdweb">🦁 Adding metamask authentication using thirdweb</h2> <p>We would have to install a few packages so that we can build the metamask authentication using thirdweb.</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yarn add @thirdweb-dev/react @thirdweb-dev/sdk ethers
</code></pre></div></div> <p>After you have installed it, go ahead and open the <code class="language-plaintext highlighter-rouge">pages/_app.tsx</code> file. We would have to set up the <code class="language-plaintext highlighter-rouge">ThirdwebProvider</code> that provides all the context consumed by your app. With this context, you will have a standard web3 provider that you can use throughout your app.</p> <p>To set up the <code class="language-plaintext highlighter-rouge">ThirdwebProvider</code> you need to just wrap your app with the following setup:</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="kd">type</span> <span class="p">{</span> <span class="nx">AppProps</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">next/app</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ThirdwebProvider</span><span class="p">,</span> <span class="nx">ChainId</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@thirdweb-dev/react</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="dl">"</span><span class="s2">../styles/globals.css</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">MyApp</span><span class="p">({</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">pageProps</span> <span class="p">}:</span> <span class="nx">AppProps</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">desiredChainId</span> <span class="o">=</span> <span class="nx">ChainId</span><span class="p">.</span><span class="nx">Mumbai</span><span class="p">;</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">ThirdwebProvider</span> <span class="na">desiredChainId</span><span class="p">=</span><span class="si">{</span><span class="nx">desiredChainId</span><span class="si">}</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">Component</span> <span class="si">{</span><span class="p">...</span><span class="nx">pageProps</span><span class="si">}</span> <span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nc">ThirdwebProvider</span><span class="p">&gt;</span>
  <span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">MyApp</span><span class="p">;</span>
</code></pre></div></div> <p>Let’s now add the feature where the user can click a button and can connect their wallet to the website.</p> <p>Head over to the <code class="language-plaintext highlighter-rouge">pages/index.tsx</code> file and add the following code:</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="kd">type</span> <span class="p">{</span> <span class="nx">NextPage</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">next</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span>
  <span class="nx">useAddress</span><span class="p">,</span>
  <span class="nx">useMetamask</span><span class="p">,</span>
  <span class="nx">useCoinbaseWallet</span><span class="p">,</span>
  <span class="nx">useWalletConnect</span><span class="p">,</span>
  <span class="nx">useDisconnect</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@thirdweb-dev/react</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">Home</span><span class="p">:</span> <span class="nx">NextPage</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">connectWithCoinbaseWallet</span> <span class="o">=</span> <span class="nx">useCoinbaseWallet</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">connectWithMetamask</span> <span class="o">=</span> <span class="nx">useMetamask</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">connectWithWalletConnect</span> <span class="o">=</span> <span class="nx">useWalletConnect</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">address</span> <span class="o">=</span> <span class="nx">useAddress</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">disconnectWallet</span> <span class="o">=</span> <span class="nx">useDisconnect</span><span class="p">();</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">address</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span> <span class="na">className</span><span class="p">=</span><span class="s">"m-12 font-medium text-gray-600"</span><span class="p">&gt;</span>Address: <span class="si">{</span><span class="nx">address</span><span class="si">}</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span>
          <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="nx">disconnectWallet</span><span class="si">}</span>
          <span class="na">className</span><span class="p">=</span><span class="s">"w-64 rounded-full bg-blue-600 py-2 font-medium text-white transition-all duration-75 hover:bg-blue-500"</span>
        <span class="p">&gt;</span>
          Disconnect
        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="p">=</span><span class="s">"flex min-h-screen w-full flex-col items-center justify-center gap-4 bg-gray-50"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span>
          <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="nx">connectWithCoinbaseWallet</span><span class="si">}</span>
          <span class="na">className</span><span class="p">=</span><span class="s">"w-64 rounded-full bg-blue-600 py-2 font-medium text-white transition-all duration-75 hover:bg-blue-500"</span>
        <span class="p">&gt;</span>
          Connect Coinbase Wallet
        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span>
          <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="nx">connectWithMetamask</span><span class="si">}</span>
          <span class="na">className</span><span class="p">=</span><span class="s">"w-64 rounded-full bg-blue-600 py-2 font-medium text-white transition-all duration-75 hover:bg-blue-500"</span>
        <span class="p">&gt;</span>
          Connect MetaMask
        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span>
          <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="nx">connectWithWalletConnect</span><span class="si">}</span>
          <span class="na">className</span><span class="p">=</span><span class="s">"w-64 rounded-full bg-blue-600 py-2 font-medium text-white transition-all duration-75 hover:bg-blue-500"</span>
        <span class="p">&gt;</span>
          Connect WalletConnect
        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/&gt;</span>
  <span class="p">);</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Home</span><span class="p">;</span>
</code></pre></div></div> <p>Let’s understand what kind of magic is the above code doing 👀</p> <p>We are using the React hooks provided by the <code class="language-plaintext highlighter-rouge">@thirdweb-dev/react</code> package which we have installed just a while ago. We are importing the following hooks:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">useAddress</code>, Used to get the address when the user has successfully authenticated themselves via metamask</li> <li> <code class="language-plaintext highlighter-rouge">connectWithMetamask</code>, Used to open the metamask popup from which the user can authenticate themselves</li> <li> <code class="language-plaintext highlighter-rouge">connectWithCoinbaseWallet</code>, Used to authenticate the user via <a href="https://www.coinbase.com/wallet" rel="nofollow noopener noreferrer" target="_blank">Coinbase Wallet</a> </li> <li> <code class="language-plaintext highlighter-rouge">connectWithWalletConnect</code>, Used to authenticate the user via <a href="https://walletconnect.com/" rel="nofollow noopener noreferrer" target="_blank">Wallet Connect</a> </li> </ul> <p>Let’s now test it out by running <code class="language-plaintext highlighter-rouge">yarn dev</code> command.</p> <div class="mb-6 aspect-video"> <iframe src="https://www.youtube.com/embed/Kk5WpFlbC4Y" class="w-full h-full rounded-xl" allowfullscreen="" loading="lazy"> </iframe> </div> <p>🎉 Woohoo!! It’s working</p> <h2 id="-building-the-done-page">🎨 Building the done page</h2> <p>Let’s now build the done page. We are going to keep it simple as of this tutorial, you can improve the UI as you wish.</p> <p>Create a new file named <code class="language-plaintext highlighter-rouge">done.tsx</code> under the <code class="language-plaintext highlighter-rouge">pages</code> folder and add the following code:</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="kd">type</span> <span class="p">{</span> <span class="nx">NextPage</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">next</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">Done</span><span class="p">:</span> <span class="nx">NextPage</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">p</span> <span class="na">className</span><span class="p">=</span><span class="s">"m-12 font-medium text-gray-600"</span><span class="p">&gt;</span>
      You have successfully connected your metamask wallet to the CLI. You can
      now close this tab and return to the CLI
    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
  <span class="p">);</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Done</span><span class="p">;</span>
</code></pre></div></div> <h1 id="️-building-the-cli">🛠️ Building the CLI</h1> <h2 id="-creating-a-new-cli-project-using-oclif">🏗 Creating a new CLI project using Oclif</h2> <p>Let’s create a new CLI project using the following command:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx oclif generate cli
</code></pre></div></div> <p>Fill in the inputs which are been asked and hit enter. This should generate a folder structure similar to this:</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/IbGbxej.png" alt="" loading="lazy"></p> <blockquote> <p>Psst… I am making a monorepo for this tutorial. So make sure to add the code responsible for CLI into the <code class="language-plaintext highlighter-rouge">cli</code> folder and the code responsible for the website into the <code class="language-plaintext highlighter-rouge">web</code> folder.</p> </blockquote> <p>Let’s now delete some default generated files by Oclif that we are not going to be using in this tutorial.</p> <ul> <li>We are not going to write any kind of tests for this tutorial. So let’s just delete the <code class="language-plaintext highlighter-rouge">tests</code> folder and the <code class="language-plaintext highlighter-rouge">.mocharc.json</code> file.</li> <li>We are not going to be using CircleCI for this tutorial. So let’s just delete the <code class="language-plaintext highlighter-rouge">.circleci</code> folder.</li> <li>Oclif has also generated a default command (<code class="language-plaintext highlighter-rouge">hello</code>) which isn’t necessary for this tutorial, so let’s just delete the <code class="language-plaintext highlighter-rouge">src/commands/hello</code> folder.</li> </ul> <h2 id="-building-the-login-command">🔑 Building the login command</h2> <p>Oclif CLI has pretty useful generator commands which can be used to generate commands quickly!</p> <p>Let’s create a new command named <code class="language-plaintext highlighter-rouge">login</code> which would be used to authenticate the user via metamask.</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx oclif generate <span class="nb">command </span>login
</code></pre></div></div> <p>This would generate two files:</p> <ul> <li><code class="language-plaintext highlighter-rouge">src/commands/login.ts</code></li> <li><code class="language-plaintext highlighter-rouge">src/test/commands/login.test.ts</code></li> </ul> <p>As I have said before, we would be not writing any tests in this tutorial. So let’s just delete the <code class="language-plaintext highlighter-rouge">test</code> folder again.</p> <p>Head over to the <code class="language-plaintext highlighter-rouge">src/commands/login.ts</code> file. You would see that there is a lot of boilerplate code.</p> <p>Let’s clean it up and add a console log to run the <code class="language-plaintext highlighter-rouge">run</code> function by which we can verify that our Oclif CLI setup doesn’t have any issues.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Command</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@oclif/core</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Login</span> <span class="kd">extends</span> <span class="nx">Command</span> <span class="p">{</span>
  <span class="k">static</span> <span class="nx">description</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">🦁 Connect your Metamask wallet to the faucet CLI</span><span class="dl">"</span><span class="p">;</span>

  <span class="k">static</span> <span class="nx">examples</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">faucet-cli login</span><span class="dl">"</span><span class="p">];</span>

  <span class="k">async</span> <span class="nx">run</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">🎉 It's working!</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>The <code class="language-plaintext highlighter-rouge">description</code> and the <code class="language-plaintext highlighter-rouge">examples</code> are shown in the help sub-command.</p> <p>Let’s test the CLI out but first, we need to compile TypeScript code into JavaScript code. We do it by running the <code class="language-plaintext highlighter-rouge">yarn build</code> command. It would create a <code class="language-plaintext highlighter-rouge">dist</code> folder with the compiled JavaScript code.</p> <p>To run the CLI, we need to run the <code class="language-plaintext highlighter-rouge">run</code> file present in the <code class="language-plaintext highlighter-rouge">bin</code> folder along with the command. So to run the <code class="language-plaintext highlighter-rouge">login</code> command, we have to run the <code class="language-plaintext highlighter-rouge">./bin/run login</code> command.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/pYbAEBw.png" alt="https://imgur.com/pYbAEBw.png" loading="lazy"></p> <p>🎉 Woohoo! It’s working!</p> <p>Let’s now actually build the login command 👀.</p> <p>Create a new folder named <code class="language-plaintext highlighter-rouge">lib</code> and then create a new file under it named <code class="language-plaintext highlighter-rouge">connectWallet.ts</code>. This file would contain the logic to connect the user’s wallet to the CLI.</p> <p>Let’s install a package called <a href="https://www.npmjs.com/package/inquirer" rel="nofollow noopener noreferrer" target="_blank"><code class="language-plaintext highlighter-rouge">inquirer</code></a> which is used to prompt the user for input. We would be using this package to prompt the user to open the browser or not.</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yarn add inquirer
</code></pre></div></div> <p>As we are using TypeScript, we need also to install <a href="https://npmjs.com/package/@types/inquirer" rel="nofollow noopener noreferrer" target="_blank"><code class="language-plaintext highlighter-rouge">@types/inquirer</code></a> as a dev dependency. The <code class="language-plaintext highlighter-rouge">@types/inquirer</code> package includes the type declarations for the <code class="language-plaintext highlighter-rouge">inquirer</code> package.</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yarn add <span class="nt">-D</span> @types/inquirer
</code></pre></div></div> <p>Let’s import the <code class="language-plaintext highlighter-rouge">inquirer</code> package into our <code class="language-plaintext highlighter-rouge">src/lib/connectWallet.ts</code> file.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">inquirer</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">inquirer</span><span class="dl">"</span><span class="p">;</span>
</code></pre></div></div> <p>Let’s now programmatically create a prompt that asks the user whether to open the browser or not using inquirer.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">inquirer</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">inquirer</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">connectWallet</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">inquirer</span>
    <span class="p">.</span><span class="nx">prompt</span><span class="p">([</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">openBrowser</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">confirm</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">message</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Would you like to open the browser to connect wallet?</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">default</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">])</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">answer</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">answer</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">connectWallet</span><span class="p">;</span>
</code></pre></div></div> <p>I have wrapped the entire code which is responsible for connecting the user’s wallet inside a function. As we are going to be importing this into the <code class="language-plaintext highlighter-rouge">src/commands/login.ts</code> file.</p> <p>Let’s import the <code class="language-plaintext highlighter-rouge">connectWallet</code> function into our <code class="language-plaintext highlighter-rouge">src/commands/login.ts</code> file and call it inside the <code class="language-plaintext highlighter-rouge">run</code> function.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Command</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@oclif/core</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">connectWallet</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/connectWallet</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Login</span> <span class="kd">extends</span> <span class="nx">Command</span> <span class="p">{</span>
  <span class="k">static</span> <span class="nx">description</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">🦁 Connect your Metamask wallet to the faucet CLI</span><span class="dl">"</span><span class="p">;</span>

  <span class="k">static</span> <span class="nx">examples</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">faucet-cli login</span><span class="dl">"</span><span class="p">];</span>

  <span class="k">async</span> <span class="nx">run</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">connectWallet</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Let’s build the code and test it out.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/OSbXO8A.png" alt="https://imgur.com/OSbXO8A.png" loading="lazy"></p> <p>As you can see the inquirer package returns an object with the key as the name of the prompt and the value as the answer.</p> <p>Let’s add a console log that says that the user won’t be able to use the request command if they don’t connect their wallet.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">inquirer</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">inquirer</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">connectWallet</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">inquirer</span>
    <span class="p">.</span><span class="nx">prompt</span><span class="p">([</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">openBrowser</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">confirm</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">message</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Would you like to open the browser to connect wallet?</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">default</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">])</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">answer</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">answer</span><span class="p">.</span><span class="nx">openBrowser</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
          <span class="dl">"</span><span class="s2">You won't be able to request testnet tokens if you don't connect your wallet.</span><span class="dl">"</span>
        <span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">connectWallet</span><span class="p">;</span>
</code></pre></div></div> <p>Let’s now start building the cool part of the CLI, authenticating the user 🦄.</p> <p>We need to first need a few packages:</p> <ul> <li> <a href="https://www.npmjs.com/package/express" rel="nofollow noopener noreferrer" target="_blank"><code class="language-plaintext highlighter-rouge">express</code></a>, to start a local server at port <code class="language-plaintext highlighter-rouge">9991</code> to handle the authentication.</li> <li> <a href="https://www.npmjs.com/package/open" rel="nofollow noopener noreferrer" target="_blank"><code class="language-plaintext highlighter-rouge">open</code></a>, to open links in the browser from the cli.</li> <li> <a href="https://www.npmjs.com/package/chalk" rel="nofollow noopener noreferrer" target="_blank"><code class="language-plaintext highlighter-rouge">chalk</code></a>, to colorize the console output.</li> </ul> <p>To install all of the above packages, run the following command:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yarn add express open chalk@4.1.2
</code></pre></div></div> <p>We are using the <a href="https://github.com/chalk/chalk/releases/tag/v4.1.2" rel="nofollow noopener noreferrer" target="_blank">v4.1.2</a> of chalk as <a href="https://github.com/chalk/chalk/releases/tag/v5.0.0" rel="nofollow noopener noreferrer" target="_blank">v5</a> of chalk is complete ESM module. As we are using TypeScript, it is better to stay on the v4.1.2.</p> <p>As we are using Typescript, we need also to install the TypeScript declarations for the above packages. <code class="language-plaintext highlighter-rouge">chalk</code> and <code class="language-plaintext highlighter-rouge">open</code> come with in-built TypeScript declarations. So we need to just install the TypeScript declarations for the <code class="language-plaintext highlighter-rouge">express</code> package.</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yarn add <span class="nt">-D</span> @types/express
</code></pre></div></div> <p>Let’s start a local express application when the user chooses <code class="language-plaintext highlighter-rouge">Yes</code> for the prompt.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">inquirer</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">inquirer</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">express</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">express</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">open</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">open</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">connectWallet</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">inquirer</span>
    <span class="p">.</span><span class="nx">prompt</span><span class="p">([</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">openBrowser</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">confirm</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">message</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Would you like to open the browser to connect wallet?</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">default</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">])</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">answer</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">answer</span><span class="p">.</span><span class="nx">openBrowser</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
          <span class="dl">"</span><span class="s2">You won't be able to request testnet tokens if you don't connect your wallet.</span><span class="dl">"</span>
        <span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="na">app</span><span class="p">:</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Application</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>

        <span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>
        <span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span> <span class="na">extended</span><span class="p">:</span> <span class="kc">false</span> <span class="p">}));</span>

        <span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">9991</span><span class="p">);</span>

        <span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>

        <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>

        <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">connectWallet</span><span class="p">;</span>
</code></pre></div></div> <p>👀 We have to change some code in the website. So let’s head back to the <code class="language-plaintext highlighter-rouge">web</code> folder and open the <code class="language-plaintext highlighter-rouge">pages/index.tsx</code> file. Let’s replace the code where we were showing the user’s wallet address after they have connected theirs to redirecting the user to the local express’s <code class="language-plaintext highlighter-rouge">/callback</code> with the address query parameter.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="kd">type</span> <span class="p">{</span> <span class="nx">NextPage</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">next</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span>
  <span class="nx">useAddress</span><span class="p">,</span>
  <span class="nx">useMetamask</span><span class="p">,</span>
  <span class="nx">useCoinbaseWallet</span><span class="p">,</span>
  <span class="nx">useWalletConnect</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@thirdweb-dev/react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useRouter</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">next/router</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">Home</span><span class="p">:</span> <span class="nx">NextPage</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">connectWithCoinbaseWallet</span> <span class="o">=</span> <span class="nx">useCoinbaseWallet</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">connectWithMetamask</span> <span class="o">=</span> <span class="nx">useMetamask</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">connectWithWalletConnect</span> <span class="o">=</span> <span class="nx">useWalletConnect</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">address</span> <span class="o">=</span> <span class="nx">useAddress</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">useRouter</span><span class="p">();</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">address</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">`http://localhost:9991/callback?address=</span><span class="p">${</span><span class="nx">address</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="p">=</span><span class="s">"flex min-h-screen w-full flex-col items-center justify-center gap-4 bg-gray-50"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span>
          <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="nx">connectWithCoinbaseWallet</span><span class="si">}</span>
          <span class="na">className</span><span class="p">=</span><span class="s">"w-64 rounded-full bg-blue-600 py-2 font-medium text-white transition-all duration-75 hover:bg-blue-500"</span>
        <span class="p">&gt;</span>
          Connect Coinbase Wallet
        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span>
          <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="nx">connectWithMetamask</span><span class="si">}</span>
          <span class="na">className</span><span class="p">=</span><span class="s">"w-64 rounded-full bg-blue-600 py-2 font-medium text-white transition-all duration-75 hover:bg-blue-500"</span>
        <span class="p">&gt;</span>
          Connect MetaMask
        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span>
          <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="nx">connectWithWalletConnect</span><span class="si">}</span>
          <span class="na">className</span><span class="p">=</span><span class="s">"w-64 rounded-full bg-blue-600 py-2 font-medium text-white transition-all duration-75 hover:bg-blue-500"</span>
        <span class="p">&gt;</span>
          Connect WalletConnect
        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/&gt;</span>
  <span class="p">);</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Home</span><span class="p">;</span>
</code></pre></div></div> <p>Let’s now try to open the <code class="language-plaintext highlighter-rouge">http://localhost:3000</code> in the browser and console log the user’s wallet address when he successfully connected his wallet.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">inquirer</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">inquirer</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">express</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">express</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">open</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">open</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">connectWallet</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">inquirer</span>
    <span class="p">.</span><span class="nx">prompt</span><span class="p">([</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">openBrowser</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">confirm</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">message</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Would you like to open the browser to connect wallet?</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">default</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">])</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">answer</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">answer</span><span class="p">.</span><span class="nx">openBrowser</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
          <span class="dl">"</span><span class="s2">You won't be able to request testnet tokens if you don't connect your wallet.</span><span class="dl">"</span>
        <span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="na">app</span><span class="p">:</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Application</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>

        <span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>
        <span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span> <span class="na">extended</span><span class="p">:</span> <span class="kc">false</span> <span class="p">}));</span>

        <span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">9991</span><span class="p">);</span>

        <span class="kd">let</span> <span class="na">resolve</span><span class="p">:</span> <span class="kr">any</span><span class="p">;</span>

        <span class="kd">const</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">_resolve</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">resolve</span> <span class="o">=</span> <span class="nx">_resolve</span><span class="p">;</span>
        <span class="p">});</span>

        <span class="c1">// get the address query param which is been sent by the website and redirecting the user to the done page.</span>
        <span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
          <span class="dl">"</span><span class="s2">/callback</span><span class="dl">"</span><span class="p">,</span>
          <span class="k">async</span> <span class="p">(</span><span class="na">req</span><span class="p">:</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Request</span><span class="p">,</span> <span class="na">res</span><span class="p">:</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">resolve</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://localhost:3000/done</span><span class="dl">"</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">);</span>

        <span class="c1">// opening the main website in browser</span>
        <span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://localhost:3000</span><span class="dl">"</span><span class="p">);</span>

        <span class="c1">// grabbing the address from the query param</span>
        <span class="kd">const</span> <span class="nx">code</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">p</span><span class="p">;</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">code</span><span class="p">);</span>

        <span class="c1">// closing the server as we don't want it to run forever</span>
        <span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>

        <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>

        <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">connectWallet</span><span class="p">;</span>
</code></pre></div></div> <p>Let’s test it out by starting the website with the <code class="language-plaintext highlighter-rouge">yarn dev</code> command. Make sure that you are present in the <code class="language-plaintext highlighter-rouge">web</code> folder before running this command.</p> <p>Let’s also compile the TypeScript code of the CLI into JavaScript by using the <code class="language-plaintext highlighter-rouge">yarn build</code> command. Make sure that you are present in the <code class="language-plaintext highlighter-rouge">cli</code> folder before running this command.</p> <p>Let’s now finally test the login command by running the <code class="language-plaintext highlighter-rouge">./bin/run login</code> command while being there in the <code class="language-plaintext highlighter-rouge">cli</code> directory.</p> <div class="mb-6 aspect-video"> <iframe src="https://www.youtube.com/embed/w-aUXaZueLE" class="w-full h-full rounded-xl" allowfullscreen="" loading="lazy"> </iframe> </div> <p>👀 We are missing out on something…</p> <p>We don’t want the user to connect their wallet every single time they use our CLI to request testnet tokens. So let’s store the user’s wallet address in a local file that lives in the user’s root directory. The path of the config file (<code class="language-plaintext highlighter-rouge">config.json</code>) would be something like this <code class="language-plaintext highlighter-rouge">&lt;user's-root-dir&gt;/.thw-faucet-cli/config.json</code>. The structure of content inside the <code class="language-plaintext highlighter-rouge">config.json</code> would be something like this:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x0"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Create a new folder named <code class="language-plaintext highlighter-rouge">utils</code> and create a new file under it named <code class="language-plaintext highlighter-rouge">saveAddress.ts</code>. This file would contain the logic for creating a new file and then writing the user’s wallet address to it.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">fs</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">fs</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">os</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">os</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">configFilePath</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../constants/constants</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">saveAddress</span> <span class="o">=</span> <span class="p">(</span><span class="nx">address</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">mkdirSync</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">os</span><span class="p">.</span><span class="nx">homedir</span><span class="p">()}</span><span class="s2">/.thw-faucet-cli`</span><span class="p">);</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFileSync</span><span class="p">(</span><span class="nx">configFilePath</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="na">address</span><span class="p">:</span> <span class="nx">address</span> <span class="p">}));</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">saveAddress</span><span class="p">;</span>
</code></pre></div></div> <p>I have created a new file named <code class="language-plaintext highlighter-rouge">constants/constants.ts</code> which contains the path of the config file. I did this because we are going to be using the path of the file in multiple places.</p> <p>Let’s import the <code class="language-plaintext highlighter-rouge">saveAddress</code> function into the <code class="language-plaintext highlighter-rouge">lib/connectWallet.ts</code> file and call it along with the user’s wallet address as the parameter.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">inquirer</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">inquirer</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">express</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">express</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">open</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">open</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">chalk</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">chalk</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">saveAddress</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../utils/saveAddress</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">connectWallet</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">inquirer</span>
    <span class="p">.</span><span class="nx">prompt</span><span class="p">([</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">openBrowser</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">confirm</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">message</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Would you like to open the browser to connect wallet?</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">default</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">])</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">answer</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">answer</span><span class="p">.</span><span class="nx">openBrowser</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
          <span class="dl">"</span><span class="s2">You won't be able to request testnet tokens if you don't connect your wallet.</span><span class="dl">"</span>
        <span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="na">app</span><span class="p">:</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Application</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>

        <span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>
        <span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span> <span class="na">extended</span><span class="p">:</span> <span class="kc">false</span> <span class="p">}));</span>

        <span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">9991</span><span class="p">);</span>

        <span class="kd">let</span> <span class="na">resolve</span><span class="p">:</span> <span class="kr">any</span><span class="p">;</span>

        <span class="kd">const</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">_resolve</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">resolve</span> <span class="o">=</span> <span class="nx">_resolve</span><span class="p">;</span>
        <span class="p">});</span>

        <span class="c1">// get the address query param which is been sent by the website and redirecting the user to the done page.</span>
        <span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
          <span class="dl">"</span><span class="s2">/callback</span><span class="dl">"</span><span class="p">,</span>
          <span class="k">async</span> <span class="p">(</span><span class="na">req</span><span class="p">:</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Request</span><span class="p">,</span> <span class="na">res</span><span class="p">:</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">resolve</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://localhost:3000/done</span><span class="dl">"</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">);</span>

        <span class="c1">// opening the main website in browser</span>
        <span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://localhost:3000</span><span class="dl">"</span><span class="p">);</span>

        <span class="c1">// grabbing the address from the query param</span>
        <span class="kd">const</span> <span class="nx">code</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">p</span><span class="p">;</span>

        <span class="c1">// storing the user's address locally in the config file</span>
        <span class="nx">saveAddress</span><span class="p">(</span><span class="nx">code</span> <span class="k">as</span> <span class="kr">string</span><span class="p">);</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
          <span class="nx">chalk</span><span class="p">.</span><span class="nx">greenBright</span><span class="p">(</span>
            <span class="s2">`\nYou have successfully connected your wallet to the faucet CLI!\nWallet address: </span><span class="p">${</span><span class="nx">code</span><span class="p">}</span><span class="s2">`</span>
          <span class="p">)</span>
        <span class="p">);</span>

        <span class="c1">// closing the server as we don't want it to run forever</span>
        <span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>

        <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>

        <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">connectWallet</span><span class="p">;</span>
</code></pre></div></div> <p>If the user has logged in once and the address has been saved then if the user tried to log in again, then it would be a problem 🤔. So let’s first check if the <code class="language-plaintext highlighter-rouge">config.json</code> file exists or not. If it exists then call the <code class="language-plaintext highlighter-rouge">connectWallet</code> function or else console log that the user is already logged in.</p> <p>Let’s create a new file named <code class="language-plaintext highlighter-rouge">utils/getToken.ts</code> which contains the logic for getting the token which is been stored in the local file (<code class="language-plaintext highlighter-rouge">config.json</code>).</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">fs</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">fs</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">configFilePath</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../constants/constants</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">getToken</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">configFilePath</span><span class="p">,</span> <span class="dl">"</span><span class="s2">utf8</span><span class="dl">"</span><span class="p">));</span>
    <span class="k">return</span> <span class="nx">config</span><span class="p">.</span><span class="nx">address</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">getToken</span><span class="p">;</span>
</code></pre></div></div> <p>We are returning <code class="language-plaintext highlighter-rouge">null</code> if the <code class="language-plaintext highlighter-rouge">address</code> key in the <code class="language-plaintext highlighter-rouge">config.json</code> file doesn’t exist and the value of the <code class="language-plaintext highlighter-rouge">address</code> key if it exists.</p> <p>Let’s import the <code class="language-plaintext highlighter-rouge">getToken</code> function into the <code class="language-plaintext highlighter-rouge">src/commands/login.ts</code> file and call it.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Command</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@oclif/core</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">chalk</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">chalk</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">connectWallet</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/connectWallet</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">getToken</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../utils/getToken</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Login</span> <span class="kd">extends</span> <span class="nx">Command</span> <span class="p">{</span>
  <span class="k">static</span> <span class="nx">description</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">🦁 Connect your Metamask wallet to the faucet CLI</span><span class="dl">"</span><span class="p">;</span>

  <span class="k">static</span> <span class="nx">examples</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">faucet-cli login</span><span class="dl">"</span><span class="p">];</span>

  <span class="k">async</span> <span class="nx">run</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// checking if the user is already logged in or not</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">getToken</span><span class="p">()</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">chalk</span><span class="p">.</span><span class="nx">redBright</span><span class="p">(</span><span class="dl">"</span><span class="se">\n</span><span class="s2">You are already logged in!</span><span class="dl">"</span><span class="p">));</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">connectWallet</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Let’s test it out 👀</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/847lRJj.png" alt="" loading="lazy"></p> <p>🎉 Woohoo! We have successfully made the login command. Phew! That was long. Let’s take a coffee break ☕.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://c.tenor.com/2KcNT1aGdNEAAAAC/coffee-need.gif" alt="" loading="lazy"></p> <p>Let’s back to work now 🚀!</p> <h2 id="-building-request-command">🚰 Building request command</h2> <p>Let’s start building the main core command of the CLI, the <code class="language-plaintext highlighter-rouge">request</code> command.</p> <h3 id="️-workflow-of-the-request-command">👷‍♂️ Workflow of the request command</h3> <p>Let’s understand the workflow of the request command:</p> <ul> <li>The user first uses the <code class="language-plaintext highlighter-rouge">request</code> command, we would check if the user is logged in or not via the <code class="language-plaintext highlighter-rouge">getToken</code> function.</li> <li>If the user is not logged in, then we console log saying that you need to be logged in to use this command.</li> <li>If the user is logged in, then send a request to the backend with the specified network (for this tutorial I am going to be Rinkeby and Polygon Mumbai testnet networks)</li> <li>The backend would use web3.js and ethers to send the testnet tokens to the user and it would return with the transaction hash in the response.</li> </ul> <p>Let’s use Oclif’s CLI to generate a new command:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx oclif generate <span class="nb">command </span>request
</code></pre></div></div> <p>As I have mentioned before, we would not be writing any kinds of test in this tutorial. So let’s delete the generated <code class="language-plaintext highlighter-rouge">test</code> folder again.</p> <p>Go ahead and open the <code class="language-plaintext highlighter-rouge">src/commands/request.ts</code> file and let’s clean the boilerplate code.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Command</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@oclif/core</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Request</span> <span class="kd">extends</span> <span class="nx">Command</span> <span class="p">{</span>
  <span class="k">static</span> <span class="nx">description</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">🚰 Request for testnet tokens</span><span class="dl">"</span><span class="p">;</span>

  <span class="k">async</span> <span class="nx">run</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Let’s use the inquirer package to prompt the user with the supported testnet networks. In this tutorial, I would be using Rinkeby and Polygon Mumbai. Feel free to add any testnet network in which you have a sufficient amount of tokens to build a faucet out of it.</p> <p>Let’s create a file named <code class="language-plaintext highlighter-rouge">src/data/questions.ts</code> which would contain an array with all the questions which would be prompted to the user. I have created another file named <code class="language-plaintext highlighter-rouge">src/data/networks.ts</code> which would contain an array with all the supported testnet networks.</p> <p><code class="language-plaintext highlighter-rouge">src/data/networks.ts</code></p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">networks</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">mumbai</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">rinkeby</span><span class="dl">"</span><span class="p">];</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">networks</span><span class="p">;</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">src/data/questions.ts</code></p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">networks</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./networks</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">questions</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">list</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">network</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">message</span><span class="p">:</span>
      <span class="dl">"</span><span class="s2">🦄 choose the testnet network on which you want to request the tokens</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">choices</span><span class="p">:</span> <span class="nx">networks</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">];</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">questions</span><span class="p">;</span>
</code></pre></div></div> <p>Let’s import the <code class="language-plaintext highlighter-rouge">questions</code> array in the <code class="language-plaintext highlighter-rouge">src/commands/request.ts</code> file and use the inquirer package to create a prompt out of it.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Command</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@oclif/core</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">inquirer</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">inquirer</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">questions</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../data/questions</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Request</span> <span class="kd">extends</span> <span class="nx">Command</span> <span class="p">{</span>
  <span class="k">static</span> <span class="nx">description</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">🚰 Request for testnet tokens</span><span class="dl">"</span><span class="p">;</span>

  <span class="k">async</span> <span class="nx">run</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">inquirer</span><span class="p">.</span><span class="nx">prompt</span><span class="p">(</span><span class="nx">questions</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">answers</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>👀 Oh wait… We forgot to check whether the user is logged in or not firstly. Let’s import the <code class="language-plaintext highlighter-rouge">getToken</code> function into the <code class="language-plaintext highlighter-rouge">src/commands/request.ts</code> file and call it.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Command</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@oclif/core</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">inquirer</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">inquirer</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">chalk</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">chalk</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">getToken</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../utils/getToken</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">questions</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../data/questions</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Request</span> <span class="kd">extends</span> <span class="nx">Command</span> <span class="p">{</span>
  <span class="k">static</span> <span class="nx">description</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">🚰 Request for testnet tokens</span><span class="dl">"</span><span class="p">;</span>

  <span class="k">async</span> <span class="nx">run</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">getToken</span><span class="p">()</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
        <span class="nx">chalk</span><span class="p">.</span><span class="nx">redBright</span><span class="p">(</span>
          <span class="dl">"</span><span class="se">\n</span><span class="s2">You need to be logged in first to use this command!</span><span class="se">\n</span><span class="s2">Use `faucet-cli login` command to login.</span><span class="dl">"</span>
        <span class="p">)</span>
      <span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">inquirer</span><span class="p">.</span><span class="nx">prompt</span><span class="p">(</span><span class="nx">questions</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">answers</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h1 id="-building-the-backend">✨ Building the backend</h1> <p>Let’s now start building the backend 🦄.</p> <p>Create a new folder named <code class="language-plaintext highlighter-rouge">server</code> in the root directory.</p> <p>Let’s initialize a new npm project by using the <code class="language-plaintext highlighter-rouge">yarn init -y</code> command. Make sure to run <code class="language-plaintext highlighter-rouge">cd server</code>, if you are present in the root directory. This should generate a <code class="language-plaintext highlighter-rouge">package.json</code> file.</p> <p>Let’s edit the <code class="language-plaintext highlighter-rouge">package.json</code> file a bit:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"server"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0.1"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"main"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dist/index.js"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"license"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MIT"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Let’s now add the packages which we would need to build the backend:</p> <ul> <li> <a href="https://www.npmjs.com/package/express" rel="nofollow noopener noreferrer" target="_blank"><code class="language-plaintext highlighter-rouge">express</code></a>, as our backend framework</li> <li> <a href="https://www.npmjs.com/package/web3" rel="nofollow noopener noreferrer" target="_blank"><code class="language-plaintext highlighter-rouge">web3</code></a> and <a href="https://www.npmjs.com/package/ethers" rel="nofollow noopener noreferrer" target="_blank"><code class="language-plaintext highlighter-rouge">ethers</code></a>, as our blockchain library</li> <li> <a href="https://www.npmjs.com/package/dotenv" rel="nofollow noopener noreferrer" target="_blank"><code class="language-plaintext highlighter-rouge">dotenv</code></a>, to read the environment variables from the <code class="language-plaintext highlighter-rouge">.env</code> file</li> </ul> <p>To install the above packages, run the following command:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yarn add express web3 ethers dotenv
</code></pre></div></div> <p>As we are using TypeScript, we would also need to install a few more packages as dev dependencies:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">@types/express</code>, type declarations for <code class="language-plaintext highlighter-rouge">express</code> </li> <li> <code class="language-plaintext highlighter-rouge">typescript</code>, to compile the TypeScript code</li> <li> <code class="language-plaintext highlighter-rouge">ts-node</code>, to run the TypeScript code</li> <li> <code class="language-plaintext highlighter-rouge">nodemon</code>, to run the reload the server on file changes</li> </ul> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yarn add <span class="nt">-D</span> @types/express typescript ts-node nodemon
</code></pre></div></div> <p>After the package has been installed, let’s create a new <code class="language-plaintext highlighter-rouge">tsconfig.json</code> where we defined the configuration to be followed by the TypeScript compiler.</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"compilerOptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"es2017"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"module"</span><span class="p">:</span><span class="w"> </span><span class="s2">"commonjs"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"lib"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"dom"</span><span class="p">,</span><span class="w"> </span><span class="s2">"es6"</span><span class="p">,</span><span class="w"> </span><span class="s2">"es2017"</span><span class="p">,</span><span class="w"> </span><span class="s2">"esnext.asynciterable"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"skipLibCheck"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"sourceMap"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"outDir"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./dist"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"moduleResolution"</span><span class="p">:</span><span class="w"> </span><span class="s2">"node"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"removeComments"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"noImplicitAny"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"strictNullChecks"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"strictFunctionTypes"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"noImplicitThis"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"noUnusedLocals"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"noUnusedParameters"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"noImplicitReturns"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"noFallthroughCasesInSwitch"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"allowSyntheticDefaultImports"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"esModuleInterop"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"emitDecoratorMetadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"experimentalDecorators"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"resolveJsonModule"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"baseUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"."</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"exclude"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"node_modules"</span><span class="p">],</span><span class="w">
  </span><span class="nl">"include"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"./src/**/*.ts"</span><span class="p">,</span><span class="w"> </span><span class="s2">"tsconfig.json"</span><span class="p">,</span><span class="w"> </span><span class="s2">"index.ts"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Let’s create a new file named <code class="language-plaintext highlighter-rouge">src/index.ts</code> and add the following code:</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">express</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Express</span><span class="p">,</span> <span class="nx">Request</span><span class="p">,</span> <span class="nx">Response</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">express</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">app</span><span class="p">:</span> <span class="nx">Express</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>

<span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">/</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">_req</span><span class="p">:</span> <span class="nx">Request</span><span class="p">,</span> <span class="nx">res</span><span class="p">:</span> <span class="nx">Response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
    <span class="na">status</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Alive!</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span> <span class="na">extended</span><span class="p">:</span> <span class="kc">false</span> <span class="p">}));</span>

<span class="kd">const</span> <span class="nx">port</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span> <span class="o">||</span> <span class="mi">3000</span><span class="p">;</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`⚡️[server]: Server is running at </span><span class="p">${</span><span class="nx">port</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div> <p>Let’s understand what does the above code does:</p> <ul> <li>We are importing the <code class="language-plaintext highlighter-rouge">express</code> package and creating an instance of <code class="language-plaintext highlighter-rouge">express</code> called <code class="language-plaintext highlighter-rouge">app</code>.</li> <li>We have defined a GET route <code class="language-plaintext highlighter-rouge">/</code> which returns a JSON object saying `status: ‘Alive!’.</li> <li>We have defined a middleware <code class="language-plaintext highlighter-rouge">app.use</code> which is used to parse the incoming request body as JSON and URL encoded.</li> <li>We are defining a <code class="language-plaintext highlighter-rouge">port</code> variable that would be used to listen to the port. The port which we are defining right now (in our case it’s <code class="language-plaintext highlighter-rouge">3000</code>) might vary from the port on which the server would run in the production mode. So, we are defining a <code class="language-plaintext highlighter-rouge">process.env.PORT</code> variable which would be used to listen to the port.</li> </ul> <p>Let’s add a few scripts in the <code class="language-plaintext highlighter-rouge">package.json</code>:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"watch"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tsc --watch"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"node dist/src/index.js"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"build"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tsc"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nodemon dist/src/index.js"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Let’s now open two terminal windows, one for compiling the TypeScript code and the other for running and automatically reloading the server on file changes. Run <code class="language-plaintext highlighter-rouge">yarn watch</code> in one of the terminals and <code class="language-plaintext highlighter-rouge">yarn dev</code> in the other terminal. Make sure that you are present in the <code class="language-plaintext highlighter-rouge">server</code> directory, if not then run the <code class="language-plaintext highlighter-rouge">cd server</code> command before running the above commands.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/nu1v6ji.png" alt="" loading="lazy"></p> <p>👀 We have just created a basic express application. Let’s now understand how can we test the routes which we have added. Currently, we only have one route but as our backend grows, we would have more and more routes.</p> <p>If you are using VSCode then there is a pretty good extension that can help you to test the API routes inside VSCode itself. Go ahead and search for <code class="language-plaintext highlighter-rouge">Thunder Client</code> in the extensions tab and install the one whose author is <code class="language-plaintext highlighter-rouge">Ranga Vadhineni</code>.</p> <p>After you have installed Thunder Client, you would see a thunder icon in the left sidebar.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/IWAyZnh.png" alt="" loading="lazy"></p> <p>Click that thunder client and you would see a webview something like this:</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/56PS9C2.png" alt="" loading="lazy"></p> <p>Click the “New Request” button and you would see a screen like this:</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/2qtTgLk.png" alt="" loading="lazy"></p> <p>If you have used Postman before then you would feel this interface is familiar.</p> <p>Let’s change the URL to <code class="language-plaintext highlighter-rouge">http://localhost:3000/</code> and click the “Send” button.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/9EyPFvl.png" alt="" loading="lazy"></p> <p>You would see the response like this:</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/rvKbvOo.png" alt="" loading="lazy"></p> <p>Let’s now start building the actual <code class="language-plaintext highlighter-rouge">request</code> route which would send the tokens to the user.</p> <p>Let’s create a new folder called <code class="language-plaintext highlighter-rouge">controllers</code>, this folder would contain the core logic for the respective routes. Create a new file called <code class="language-plaintext highlighter-rouge">request.ts</code> under the <code class="language-plaintext highlighter-rouge">controllers</code> folder.</p> <p>It’s the time to interact with the blockchain using <code class="language-plaintext highlighter-rouge">ethers</code> and <code class="language-plaintext highlighter-rouge">web3.js</code> libraries.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://c.tenor.com/siUF6_Z22eUAAAAC/wow.gif" alt="" loading="lazy"></p> <p>Let’s add the following code to the <code class="language-plaintext highlighter-rouge">src/controllers/request.ts</code> file, don’t worry we would be explaining the code:</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Request</span><span class="p">,</span> <span class="nx">Response</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">express</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ethers</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">ethers</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">dotenv</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">dotenv</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Web3</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">web3</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">constants</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../data/constants</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">chainId</span><span class="p">,</span> <span class="nx">txUrl</span><span class="p">,</span> <span class="nx">apiUrls</span><span class="p">,</span> <span class="nx">amount</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../data/networks</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">dotenv</span><span class="p">.</span><span class="nx">config</span><span class="p">();</span>

<span class="kd">const</span> <span class="nx">privateKey</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PRIVATE_KEY</span><span class="o">!</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">wallet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">Wallet</span><span class="p">(</span><span class="nx">privateKey</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">:</span> <span class="nx">Request</span><span class="p">,</span> <span class="nx">res</span><span class="p">:</span> <span class="nx">Response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">address</span> <span class="o">=</span> <span class="nx">wallet</span><span class="p">.</span><span class="nx">address</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">httpsUrl</span> <span class="o">=</span> <span class="nx">apiUrls</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">network</span><span class="o">!</span><span class="p">));</span>

  <span class="kd">var</span> <span class="nx">web3</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Web3</span><span class="p">(</span><span class="k">new</span> <span class="nx">Web3</span><span class="p">.</span><span class="nx">providers</span><span class="p">.</span><span class="nx">HttpProvider</span><span class="p">(</span><span class="nx">httpsUrl</span><span class="o">!</span><span class="p">));</span>

  <span class="kd">const</span> <span class="nx">httpsProvider</span> <span class="o">=</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">getDefaultProvider</span><span class="p">(</span><span class="nx">httpsUrl</span><span class="p">);</span>

  <span class="kd">let</span> <span class="nx">nonce</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">httpsProvider</span><span class="p">.</span><span class="nx">getTransactionCount</span><span class="p">(</span><span class="nx">address</span><span class="p">,</span> <span class="dl">"</span><span class="s2">latest</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">let</span> <span class="nx">feeData</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">httpsProvider</span><span class="p">.</span><span class="nx">getFeeData</span><span class="p">();</span>

  <span class="kd">const</span> <span class="nx">balance</span> <span class="o">=</span> <span class="nx">web3</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fromWei</span><span class="p">(</span>
    <span class="c1">// @ts-ignore</span>
    <span class="k">await</span> <span class="nx">web3</span><span class="p">.</span><span class="nx">eth</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">(</span><span class="nx">constants</span><span class="p">[</span><span class="dl">"</span><span class="s2">fromAddress</span><span class="dl">"</span><span class="p">]),</span>
    <span class="dl">"</span><span class="s2">ether</span><span class="dl">"</span>
  <span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">web3</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">isAddress</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">address</span><span class="o">!</span><span class="p">))</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
      <span class="na">error</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Invalid receiver address</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">invalidAddress</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">});</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// @ts-ignore</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">balance</span> <span class="o">&lt;</span> <span class="nx">amount</span><span class="p">?.</span><span class="kd">get</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">network</span><span class="p">)</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
        <span class="na">error</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Insufficient funds</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">insufficientFunds</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="p">});</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">tx</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">type</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="na">nonce</span><span class="p">:</span> <span class="nx">nonce</span><span class="p">,</span>
        <span class="na">to</span><span class="p">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>
        <span class="na">maxPriorityFeePerGas</span><span class="p">:</span> <span class="nx">feeData</span><span class="p">[</span><span class="dl">"</span><span class="s2">maxPriorityFeePerGas</span><span class="dl">"</span><span class="p">],</span>
        <span class="na">maxFeePerGas</span><span class="p">:</span> <span class="nx">feeData</span><span class="p">[</span><span class="dl">"</span><span class="s2">maxFeePerGas</span><span class="dl">"</span><span class="p">],</span>
        <span class="c1">// @ts-ignore</span>
        <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="nx">amount</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">network</span><span class="p">)),</span>
        <span class="na">gasLimit</span><span class="p">:</span> <span class="mi">30000</span><span class="p">,</span>
        <span class="na">chainId</span><span class="p">:</span> <span class="nx">chainId</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">network</span><span class="p">)),</span>
      <span class="p">};</span>

      <span class="c1">// @ts-ignore</span>
      <span class="kd">const</span> <span class="nx">signedTx</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">wallet</span><span class="p">.</span><span class="nx">signTransaction</span><span class="p">(</span><span class="nx">tx</span><span class="p">);</span>

      <span class="kd">const</span> <span class="nx">txHash</span> <span class="o">=</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">keccak256</span><span class="p">(</span><span class="nx">signedTx</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Precomputed txHash:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">txHash</span><span class="p">);</span>
      <span class="nx">httpsProvider</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">(</span><span class="nx">signedTx</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">);</span>

      <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
        <span class="na">txLink</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">txUrl</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">network</span><span class="p">))}</span><span class="s2">/</span><span class="p">${</span><span class="nx">txHash</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">request</span><span class="p">;</span>
</code></pre></div></div> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://c.tenor.com/f-maJKMFVRMAAAAC/kevin-hart-dst.gif" alt="" loading="lazy"></p> <p>Damn! That’s a lot of code. Let’s break it down:</p> <ul> <li>We are importing the <code class="language-plaintext highlighter-rouge">express</code> (along with the <code class="language-plaintext highlighter-rouge">Request</code> and <code class="language-plaintext highlighter-rouge">Response</code> types), <code class="language-plaintext highlighter-rouge">ethers</code>, <code class="language-plaintext highlighter-rouge">web3.js</code>, and <code class="language-plaintext highlighter-rouge">dotenv</code> libraries.</li> <li> <p>We are importing the <code class="language-plaintext highlighter-rouge">chainId</code> (Chain ID of the supported networks), <code class="language-plaintext highlighter-rouge">txUrl</code> (The URL of the blockchain explorer along with the <code class="language-plaintext highlighter-rouge">tx</code> route), <code class="language-plaintext highlighter-rouge">apiUrls</code> (URL of Alchemy project), <code class="language-plaintext highlighter-rouge">amount</code> (The amount of tokens to be sent on each network). Wait what’s this <code class="language-plaintext highlighter-rouge">data/network.ts</code> file now? What does it contain? The <code class="language-plaintext highlighter-rouge">data/networks.ts</code> basically contains a quite few hashmaps to map the network name with the properties mentioned above.</p> <div class="language-tsx highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">dotenv</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">dotenv</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">dotenv</span><span class="p">.</span><span class="nx">config</span><span class="p">();</span>

<span class="kd">const</span> <span class="nx">chainId</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">([</span>
  <span class="p">[</span><span class="dl">"</span><span class="s2">mumbai</span><span class="dl">"</span><span class="p">,</span> <span class="mi">80001</span><span class="p">],</span>
  <span class="p">[</span><span class="dl">"</span><span class="s2">rinkeby</span><span class="dl">"</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="p">]);</span>

<span class="kd">const</span> <span class="nx">txUrl</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">([</span>
  <span class="p">[</span><span class="dl">"</span><span class="s2">mumbai</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">https://mumbai.polygonscan.com/tx</span><span class="dl">"</span><span class="p">],</span>
  <span class="p">[</span><span class="dl">"</span><span class="s2">rinkeby</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">https://rinkeby.etherscan.io/tx</span><span class="dl">"</span><span class="p">],</span>
<span class="p">]);</span>

<span class="kd">const</span> <span class="nx">apiUrls</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">([</span>
  <span class="p">[</span><span class="dl">"</span><span class="s2">mumbai</span><span class="dl">"</span><span class="p">,</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">ALCHEMY_API_URL_MUMBAI</span><span class="p">],</span>
  <span class="p">[</span><span class="dl">"</span><span class="s2">rinkeby</span><span class="dl">"</span><span class="p">,</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">ALCHEMY_API_URL_RINKEBY</span><span class="p">],</span>
<span class="p">]);</span>

<span class="kd">const</span> <span class="nx">amount</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">([</span>
  <span class="p">[</span><span class="dl">"</span><span class="s2">mumbai</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">1</span><span class="dl">"</span><span class="p">],</span>
  <span class="p">[</span><span class="dl">"</span><span class="s2">rinkeby</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">0.1</span><span class="dl">"</span><span class="p">],</span>
<span class="p">]);</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">chainId</span><span class="p">,</span> <span class="nx">txUrl</span><span class="p">,</span> <span class="nx">apiUrls</span><span class="p">,</span> <span class="nx">amount</span> <span class="p">};</span>
</code></pre></div> </div> </li> <li>We configured the <code class="language-plaintext highlighter-rouge">dotenv</code> library to load the environment variables from the <code class="language-plaintext highlighter-rouge">.env</code> file.</li> <li> <p>We are creating a wallet using the <code class="language-plaintext highlighter-rouge">ethers</code> library using the private key. Wait whose private key is it? Is it the private key of the user? Nope! It’s the private key of a new metamask wallet which we are going to be creating now specifically for this faucet.</p> <blockquote> <p>If you have metamask then you can skip to step 5.</p> </blockquote> <ul> <li>To install the metamask extension, go ahead to <a href="https://metamask.io" rel="nofollow noopener noreferrer" target="_blank">Metamask</a> and install the extension.</li> <li> <p>After you have installed the extension, you would see a page something like this. Click get started.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/CriKrTv.png" alt="" loading="lazy"></p> </li> <li> <p>Click on create a new wallet</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/kkFt2qW.png" alt="" loading="lazy"></p> </li> <li> <p>Type in the password for your Metamask account</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/yn6fTB3.png" alt="" loading="lazy"></p> </li> <li> <p>Metamask would give you a <strong>secret recovery phrase</strong> which makes it easy to recover your account. <strong>Never share your secret recovery phrase with anyone</strong>.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/yq10GFB.png" alt="" loading="lazy"></p> </li> <li> <p>Let’s create a new wallet for this faucet specifically. Click on the icon of the metamask extension. You would see something like this.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/pPiTfHS.png" alt="" loading="lazy"></p> </li> <li> <p>Click on the avatar of the account which is present on the top right.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/jY3Jjck.png" alt="" loading="lazy"></p> </li> <li> <p>Select “Create Account”. This should ask you for the name of the new wallet that you are going to create.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/pDoRz7h.png" alt="" loading="lazy"></p> </li> <li> <p>After you have entered the name of the new wallet, click on the “Create” button.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/Uu4oYOb.png" alt="" loading="lazy"></p> </li> <li> <p>Let’s now export the private key of this wallet. Click on the three dots on the top right and then select “Account details”.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/SZxQbvP.png" alt="" loading="lazy"></p> </li> <li>Click on “Export private key”, and you would be asked for your metamask password. Enter that in copy the private key.</li> <li> <p>Create a new file called <code class="language-plaintext highlighter-rouge">.env</code> under the <code class="language-plaintext highlighter-rouge">server</code> folder and add the following text in that file.</p> <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>PRIVATE_KEY=&lt;add your private key over here&gt;
</code></pre></div> </div> </li> </ul> </li> <li> <p>We have then grabbed the API URL from the hashmaps of the <code class="language-plaintext highlighter-rouge">src/data/networks.ts</code> file. Wait what are these API URLs? These are the API URLs of our Alchemy project.</p> <ul> <li>If you don’t know have an account at Alchemy, you can create one at <a href="https://www.alchemy.com" rel="nofollow noopener noreferrer" target="_blank">Alchemy</a>.</li> <li> <p>After you have created the account head over to <a href="https://dashboard.alchemyapi.io" rel="nofollow noopener noreferrer" target="_blank">the dashboard</a> and create a new project. We would be creating two apps one for Rinkeby and one for Polygon Mumbai.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/77AIeaY.png" alt="" loading="lazy"></p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/AACBTq9.png" alt="" loading="lazy"></p> </li> <li> <p>After you have created the project, click on it and it would open the dashboard for that project and click on the “View key”</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/Kf4c2X7.png" alt="" loading="lazy"></p> </li> <li>Copy the HTTP API key and paste it into the <code class="language-plaintext highlighter-rouge">.env</code> file. The <code class="language-plaintext highlighter-rouge">.env</code> file would look something like this now:</li> </ul> <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>PRIVATE_KEY=&lt;add your private key over here&gt;
ALCHEMY_API_URL_MUMBAI=&lt;add the alchemy api url for the polygon mumbai network over here&gt;
ALCHEMY_API_URL_RINKEBY=&lt;add the alchemy api url for the rinkeby network over here&gt;
</code></pre></div> </div> </li> <li> <p>We are checking whether the given wallet address is valid or not using the <code class="language-plaintext highlighter-rouge">web3.js</code> library.</p> <div class="language-tsx highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="nx">web3</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">isAddress</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">address</span><span class="o">!</span><span class="p">))</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
    <span class="na">error</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Invalid receiver address</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">invalidAddress</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></div> </div> </li> <li> <p>We are also checking whether we have a sufficient amount of balance in the wallet or not.</p> <div class="language-tsx highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="nx">balance</span> <span class="o">&lt;</span> <span class="nx">amount</span><span class="p">?.</span><span class="kd">get</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">network</span><span class="p">)</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
    <span class="na">error</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Insufficient funds</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">insufficientFunds</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></div> </div> </li> <li>We are then using the <code class="language-plaintext highlighter-rouge">ethers</code> library to send the tokens to the receiver.</li> </ul> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">tx</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">type</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="na">nonce</span><span class="p">:</span> <span class="nx">nonce</span><span class="p">,</span>
  <span class="na">to</span><span class="p">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">address</span><span class="p">,</span>
  <span class="na">maxPriorityFeePerGas</span><span class="p">:</span> <span class="nx">feeData</span><span class="p">[</span><span class="dl">"</span><span class="s2">maxPriorityFeePerGas</span><span class="dl">"</span><span class="p">],</span>
  <span class="na">maxFeePerGas</span><span class="p">:</span> <span class="nx">feeData</span><span class="p">[</span><span class="dl">"</span><span class="s2">maxFeePerGas</span><span class="dl">"</span><span class="p">],</span>
  <span class="c1">// @ts-ignore</span>
  <span class="na">value</span><span class="p">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="nx">amount</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">network</span><span class="p">)),</span>
  <span class="na">gasLimit</span><span class="p">:</span> <span class="mi">30000</span><span class="p">,</span>
  <span class="na">chainId</span><span class="p">:</span> <span class="nx">chainId</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">network</span><span class="p">)),</span>
<span class="p">};</span>

<span class="c1">// @ts-ignore</span>
<span class="kd">const</span> <span class="nx">signedTx</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">wallet</span><span class="p">.</span><span class="nx">signTransaction</span><span class="p">(</span><span class="nx">tx</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">txHash</span> <span class="o">=</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">keccak256</span><span class="p">(</span><span class="nx">signedTx</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Precomputed txHash:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">txHash</span><span class="p">);</span>
<span class="nx">httpsProvider</span><span class="p">.</span><span class="nx">sendTransaction</span><span class="p">(</span><span class="nx">signedTx</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">);</span>

<span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
  <span class="na">txLink</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">txUrl</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">network</span><span class="p">))}</span><span class="s2">/</span><span class="p">${</span><span class="nx">txHash</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
<span class="p">});</span>
</code></pre></div></div> <p>Create a new file called <code class="language-plaintext highlighter-rouge">router.ts</code> under the <code class="language-plaintext highlighter-rouge">server</code> folder and add the following text in that file.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Router</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">express</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">request</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./controllers/request</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">Router</span><span class="p">();</span>

<span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">"</span><span class="s2">/request</span><span class="dl">"</span><span class="p">,</span> <span class="nx">request</span><span class="p">);</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">router</span><span class="p">;</span>
</code></pre></div></div> <p>Here we are importing the <code class="language-plaintext highlighter-rouge">request</code> controller from the <code class="language-plaintext highlighter-rouge">controllers</code> folder and creating a specific route for it (<code class="language-plaintext highlighter-rouge">/request</code>).</p> <p>Let’s now import <code class="language-plaintext highlighter-rouge">router</code> into the <code class="language-plaintext highlighter-rouge">src/index.ts</code> file and use the <code class="language-plaintext highlighter-rouge">app.use</code> method on <code class="language-plaintext highlighter-rouge">router</code></p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">router</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./router</span><span class="dl">"</span><span class="p">;</span>
</code></pre></div></div> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="dl">"</span><span class="s2">/api</span><span class="dl">"</span><span class="p">,</span> <span class="nx">router</span><span class="p">);</span>
</code></pre></div></div> <p>Let’s test the <code class="language-plaintext highlighter-rouge">/api/request</code> route but before testing, we need to get some testnet tokens into the account of the faucet CLI. Recently I have made a CLI get testnet tokens right away from the terminal so maybe it can help y’all 👀.</p> <p><a href="https://github.com/Kira272921/faucetli" rel="nofollow noopener noreferrer" target="_blank">GitHub repo</a></p> <p>If you don’t want to get the testnets tokens from the CLI, then you can get the testnet tokens from these faucets:</p> <ul> <li><a href="https://faucet.polygon.technology/" rel="nofollow noopener noreferrer" target="_blank">Polygon Mumbai faucet</a></li> <li><a href="https://faucets.chain.link/rinkeby" rel="nofollow noopener noreferrer" target="_blank">Rinkeby faucet</a></li> </ul> <p>After you have got a sufficient amount of testnet tokens, we can now test the <code class="language-plaintext highlighter-rouge">/api/request</code> route. Go ahead and open Thunder Client and change the API link to <code class="language-plaintext highlighter-rouge">http://localhost:3000/api/request</code> and change the HTTP request method to <code class="language-plaintext highlighter-rouge">POST</code>.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/deOCeaI.png" alt="" loading="lazy"></p> <p>We need to also pass the following query parameters while sending the request:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">network</code> - The network on which the user wants the testnet token. In our case, it’s either <code class="language-plaintext highlighter-rouge">mumbai</code> or <code class="language-plaintext highlighter-rouge">rinkeby</code>.</li> <li> <code class="language-plaintext highlighter-rouge">address</code> - The address of the receiver.</li> </ul> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/anGNMC9.png" alt="" loading="lazy"></p> <p>Let’s now send the request 🚀!</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/JoLSg39.png" alt="" loading="lazy"></p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/CBRXFqP.png" alt="" loading="lazy"></p> <p>🎉 Woohoo! It’s working like a charm</p> <h1 id="-integrating-the-backend-and-the-cli">👀 Integrating the backend and the CLI</h1> <p>Let’s now integrate the backend and the cli using the <a href="https://npmjs.com/package/axios" rel="nofollow noopener noreferrer" target="_blank"><code class="language-plaintext highlighter-rouge">axios</code></a> library. We would be calling the backend using axios and then console logging the transaction link into the terminal.</p> <p>Let’s create a new file called <code class="language-plaintext highlighter-rouge">src/lib/sendTokens.ts</code> under the <code class="language-plaintext highlighter-rouge">cli</code> folder. This file would be containing the core logic for calling the backend and error handling.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">ora</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">ora</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">axios</span><span class="dl">"</span><span class="p">).</span><span class="k">default</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">chalk</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">chalk</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">apiUrl</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../constants/constants</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">sendTokens</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">wallet</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">network</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">spinner</span> <span class="o">=</span> <span class="nx">ora</span><span class="p">(</span><span class="s2">`🦄 sending tokens to </span><span class="p">${</span><span class="nx">wallet</span><span class="p">}</span><span class="s2"> on </span><span class="p">${</span><span class="nx">network</span><span class="p">}</span><span class="s2">`</span><span class="p">).</span><span class="nx">start</span><span class="p">();</span>

  <span class="k">await</span> <span class="nx">axios</span>
    <span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">apiUrl</span><span class="p">}</span><span class="s2">/request?address=</span><span class="p">${</span><span class="nx">wallet</span><span class="p">}</span><span class="s2">&amp;network=</span><span class="p">${</span><span class="nx">network</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="na">res</span><span class="p">:</span> <span class="kr">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">insufficientFunds</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">spinner</span><span class="p">.</span><span class="nx">fail</span><span class="p">(</span>
          <span class="nx">chalk</span><span class="p">.</span><span class="nx">redBright</span><span class="p">(</span>
            <span class="s2">`😿 I'm out of funds! You can use the Chainlink Faucet until I get refilled. https://faucets.chain.link.\nDonate: 0x16aD561aC34818E2f314E2D1d5a777cC39f5E3aB`</span>
          <span class="p">)</span>
        <span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">invalidAddress</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">spinner</span><span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="nx">chalk</span><span class="p">.</span><span class="nx">redBright</span><span class="p">(</span><span class="s2">`🤷‍♂️ The address provided is invalid`</span><span class="p">));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">spinner</span><span class="p">.</span><span class="nx">succeed</span><span class="p">(</span>
            <span class="nx">chalk</span><span class="p">.</span><span class="nx">greenBright</span><span class="p">(</span>
              <span class="s2">`🎉 sent the tokens to </span><span class="p">${</span><span class="nx">wallet</span><span class="p">}</span><span class="s2"> on </span><span class="p">${</span><span class="nx">network</span><span class="p">}</span><span class="s2">, check </span><span class="p">${</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">txLink</span><span class="p">}</span><span class="s2"> to verify if the transaction was successful`</span>
            <span class="p">)</span>
          <span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="na">err</span><span class="p">:</span> <span class="kr">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">spinner</span><span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="nx">chalk</span><span class="p">.</span><span class="nx">redBright</span><span class="s2">`😿 </span><span class="p">${</span><span class="nx">err</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">sendTokens</span><span class="p">;</span>
</code></pre></div></div> <p>Woah! That’s a lot of code. Let’s break it down:</p> <ul> <li> <p>We are importing a package called <code class="language-plaintext highlighter-rouge">ora</code> by which we can create terminal spinners. To install <code class="language-plaintext highlighter-rouge">ora</code> run the following command:</p> <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>yarn add ora@5.4.1
</code></pre></div> </div> <p>Why are we installing the v5.4.1 of ora? Because the latest version of ora is a pure ESM module and instead of changing a hell lot of code, we can just install the version of ora which isn’t pure ESM.</p> <p>Ora comes with in-built TypeScript declarations so there is no need to install separately for its types.</p> </li> <li> <p>We are importing the <code class="language-plaintext highlighter-rouge">axios</code> package and the <code class="language-plaintext highlighter-rouge">chalk</code> package. We have already installed the <code class="language-plaintext highlighter-rouge">chalk</code> package previously. So to install <code class="language-plaintext highlighter-rouge">axios</code> package run the following command:</p> <div class="language-shell highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>yarn add axios
</code></pre></div> </div> </li> <li> <p>You might notice we are importing a variable called <code class="language-plaintext highlighter-rouge">apiUrl</code> from the <code class="language-plaintext highlighter-rouge">constants/constants.ts</code> file. The <code class="language-plaintext highlighter-rouge">apiUrl</code> variable is the base URL of the backend. As we didn’t deploy the backend till now so we would be using localhost.</p> <div class="language-tsx highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">os</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">os</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">configFilePath</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">os</span><span class="p">.</span><span class="nx">homedir</span><span class="p">()}</span><span class="s2">/.thw-faucet-cli/config.json`</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">apiUrl</span> <span class="o">=</span> <span class="s2">`http://localhost:3000`</span><span class="p">;</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">configFilePath</span><span class="p">,</span> <span class="nx">apiUrl</span> <span class="p">};</span>
</code></pre></div> </div> </li> <li> <p>We are starting a spinner by calling the <code class="language-plaintext highlighter-rouge">ora</code> function and passing the message as <code class="language-plaintext highlighter-rouge">🦄 sending tokens to ${wallet} on ${network}</code>.</p> <div class="language-tsx highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">spinner</span> <span class="o">=</span> <span class="nx">ora</span><span class="p">(</span><span class="s2">`🦄 sending tokens to </span><span class="p">${</span><span class="nx">wallet</span><span class="p">}</span><span class="s2"> on </span><span class="p">${</span><span class="nx">network</span><span class="p">}</span><span class="s2">`</span><span class="p">).</span><span class="nx">start</span><span class="p">();</span>
</code></pre></div> </div> </li> <li> <p>We are calling the backend with the <code class="language-plaintext highlighter-rouge">address</code> and <code class="language-plaintext highlighter-rouge">network</code> query parameters. We are then returning the transaction link which is sent along with the response when we call the backend.</p> </li> </ul> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">await</span> <span class="nx">axios</span>
  <span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">apiUrl</span><span class="p">}</span><span class="s2">/request?address=</span><span class="p">${</span><span class="nx">wallet</span><span class="p">}</span><span class="s2">&amp;network=</span><span class="p">${</span><span class="nx">network</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">res</span><span class="p">:</span> <span class="kr">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">insufficientFunds</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">spinner</span><span class="p">.</span><span class="nx">fail</span><span class="p">(</span>
        <span class="nx">chalk</span><span class="p">.</span><span class="nx">redBright</span><span class="p">(</span>
          <span class="s2">`😿 I'm out of funds! You can use the Chainlink Faucet until I get refilled. https://faucets.chain.link.\nDonate: 0x16aD561aC34818E2f314E2D1d5a777cC39f5E3aB`</span>
        <span class="p">)</span>
      <span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">invalidAddress</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">spinner</span><span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="nx">chalk</span><span class="p">.</span><span class="nx">redBright</span><span class="p">(</span><span class="s2">`🤷‍♂️ The address provided is invalid`</span><span class="p">));</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">spinner</span><span class="p">.</span><span class="nx">succeed</span><span class="p">(</span>
          <span class="nx">chalk</span><span class="p">.</span><span class="nx">greenBright</span><span class="p">(</span>
            <span class="s2">`🎉 sent the tokens to </span><span class="p">${</span><span class="nx">wallet</span><span class="p">}</span><span class="s2"> on </span><span class="p">${</span><span class="nx">network</span><span class="p">}</span><span class="s2">, check </span><span class="p">${</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">txLink</span><span class="p">}</span><span class="s2"> to verify if the transaction was successful`</span>
          <span class="p">)</span>
        <span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">:</span> <span class="kr">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">spinner</span><span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="nx">chalk</span><span class="p">.</span><span class="nx">redBright</span><span class="s2">`😿 </span><span class="p">${</span><span class="nx">err</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
  <span class="p">});</span>
</code></pre></div></div> <p>Let’s now import the <code class="language-plaintext highlighter-rouge">sendTokens</code> function into the <code class="language-plaintext highlighter-rouge">src/commands/request.ts</code> and call with along with the wallet address and the network parameters.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Command</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@oclif/core</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">inquirer</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">inquirer</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">chalk</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">chalk</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">sendTokens</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../lib/sendTokens</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">getToken</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../utils/getToken</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">questions</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../data/questions</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Request</span> <span class="kd">extends</span> <span class="nx">Command</span> <span class="p">{</span>
  <span class="k">static</span> <span class="nx">description</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">🚰 Request for testnet tokens</span><span class="dl">"</span><span class="p">;</span>

  <span class="k">async</span> <span class="nx">run</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">getToken</span><span class="p">()</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
        <span class="nx">chalk</span><span class="p">.</span><span class="nx">redBright</span><span class="p">(</span>
          <span class="dl">"</span><span class="se">\n</span><span class="s2">You need to be logged in first to use this command!</span><span class="se">\n</span><span class="s2">Use `faucet-cli login` command to login.</span><span class="dl">"</span>
        <span class="p">)</span>
      <span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">inquirer</span><span class="p">.</span><span class="nx">prompt</span><span class="p">(</span><span class="nx">questions</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">answers</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">sendTokens</span><span class="p">(</span><span class="nx">getToken</span><span class="p">(),</span> <span class="nx">answers</span><span class="p">.</span><span class="nx">network</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h1 id="-testing-the-entire-project">🧪 Testing the entire project</h1> <p>Let’s test it out 🚀! Let me delete the <code class="language-plaintext highlighter-rouge">.thw-faucet-cli</code> folder from my root directory as I want to test the login command as well.</p> <p>Let’s first build the code of the cli by using the <code class="language-plaintext highlighter-rouge">yarn build</code> command. Open another terminal window cd into the server folder and run the <code class="language-plaintext highlighter-rouge">yarn dev</code> command. Open another terminal window cd into the web folder and run the <code class="language-plaintext highlighter-rouge">yarn dev</code> command.</p> <p>😱 Oh no! We have just found an issue the <code class="language-plaintext highlighter-rouge">login</code> command redirects to <code class="language-plaintext highlighter-rouge">localhost:3000</code> which we thought to be the port where the frontend would run but we have given that port to the backend so let’s do a quick fix in the backend code and change the port from <code class="language-plaintext highlighter-rouge">3000</code> to <code class="language-plaintext highlighter-rouge">8080</code>. We would also have to change the <code class="language-plaintext highlighter-rouge">apiUrl</code> variable in the <code class="language-plaintext highlighter-rouge">cli/src/constants/constants.ts</code> folder.</p> <div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">os</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">os</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">configFilePath</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">os</span><span class="p">.</span><span class="nx">homedir</span><span class="p">()}</span><span class="s2">/.thw-faucet-cli/config.json`</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">apiUrl</span> <span class="o">=</span> <span class="s2">`http://localhost:8080/api`</span><span class="p">;</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">configFilePath</span><span class="p">,</span> <span class="nx">apiUrl</span> <span class="p">};</span>
</code></pre></div></div> <p>As we have changed some code in the cli folder, we would have to build the code again so let’s run the <code class="language-plaintext highlighter-rouge">yarn build</code> again.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/D1gCRZQ.png" alt="" loading="lazy"></p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/74XE9XW.png" alt="" loading="lazy"></p> <p>🎉 It’s working!!! LFG 🚀</p> <h1 id="-deploying">🚀 Deploying</h1> <p>Let’s now deploy the frontend and the backend and publish the entire cli to npmjs.</p> <h2 id="-deploying-the-frontend">🎨 Deploying the frontend</h2> <p>Let’s deploy the frontend on <a href="https://vercel.com/" rel="nofollow noopener noreferrer" target="_blank">Vercel</a>. If you are building a Next.js application and want to deploy it, Vercel is the best option in my opinion.</p> <p>Let’s first create a initialize a git repository from the root directory of the project.</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git init
</code></pre></div></div> <p>Create a <a href="https://repo.new" rel="nofollow noopener noreferrer" target="_blank">new GitHub repository</a> and push the code to the repository.</p> <p>Head over to the <a href="https://vercel.com/dashboard" rel="nofollow noopener noreferrer" target="_blank">Vercel dashboard</a> and create a new project and edit the root directory from <code class="language-plaintext highlighter-rouge">./</code> to <code class="language-plaintext highlighter-rouge">web</code>.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/XunPAf7.png" alt="" loading="lazy"></p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/Cgdi1Y4.png" alt="" loading="lazy"></p> <p>Click on deploy and that’s it 🎉!</p> <h2 id="-deploying-the-backend">🚄 Deploying the backend</h2> <p>We would be deploying the backend on <a href="https://railway.app/" rel="nofollow noopener noreferrer" target="_blank">Railway</a>. Create a new project and select “Deploy from GitHub repo”</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/4HGqGt2.png" alt="" loading="lazy"></p> <p>Select the GitHub repo and select add environment variables.</p> <p>This should create a new project for us. Open up that project you would first see that the deployment has failed, don’t worry we would fix that in a minute.</p> <p>Open the settings tab</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/k5q2vau.png" alt="" loading="lazy"></p> <p>We would have to change the scripts in the backend a bit:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nl">"watch"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tsc --watch"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"build"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tsc"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ts-node src/index.ts"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nodemon dist/src/index.js"</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span></code></pre></div></div> <p>We also need to add a file called <code class="language-plaintext highlighter-rouge">Procfile</code> which contains the start command. Create a file named <code class="language-plaintext highlighter-rouge">Procfile</code> under the <code class="language-plaintext highlighter-rouge">server</code> folder and add the following to that file:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>web: yarn start
</code></pre></div></div> <p>Push the code to the GitHub repo and this should railway should redeploy it for us.</p> <p>This should redeploy the latest commit again. You might see the deployment has failed again no worries we will fix it.</p> <p>Head over to the variables tab and bulk import the environment variables from the <code class="language-plaintext highlighter-rouge">.env</code> file. We would also need to change the root directory from <code class="language-plaintext highlighter-rouge">/</code> to <code class="language-plaintext highlighter-rouge">server</code>. Head over to the settings tab and scroll down a bit and change the root directory from <code class="language-plaintext highlighter-rouge">/</code> to <code class="language-plaintext highlighter-rouge">server</code> and add the start command as <code class="language-plaintext highlighter-rouge">yarn start</code>.</p> <p>That’s you have just deployed the backend on the railway! 🎉</p> <h2 id="-publishing-the-cli">📦 Publishing the CLI</h2> <p>Let’s now finally publish our CLI on npmjs. We would need to change the links of the backend and the frontend in the code of CLI. So let’s do that:</p> <ul> <li>In the <code class="language-plaintext highlighter-rouge">src/constants/constants.ts</code> change the backend URL from <code class="language-plaintext highlighter-rouge">localhost:8080</code> to the deployed URL of the backend.</li> <li>In the <code class="language-plaintext highlighter-rouge">src/lib/connectWallet.ts</code> change the frontend URL from <code class="language-plaintext highlighter-rouge">localhost:3000</code> to the deployed URL of the frontend.</li> </ul> <p>Let’s test the cli out for the last time.</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/ryLY9Ih.png" alt="" loading="lazy"></p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/V76k4gh.png" alt="" loading="lazy"></p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://imgur.com/VdVv0AA.png" alt="" loading="lazy"></p> <p>Woohoo! It’s working! 🎉</p> <p>Let’s now generate the README.md using oclif 👀. Run <code class="language-plaintext highlighter-rouge">yarn oclif readme</code> command. This should generate a README.md with the table of content of all the commands which we have created and their usage and descriptions.</p> <p>Let’s now publish it to npmjs by using the <code class="language-plaintext highlighter-rouge">npm publish</code> command. Woohoo! It’s finally done!</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://c.tenor.com/MkyiUsAp8t8AAAAM/tom-and-jerry-tom-the-cat.gif" alt="" loading="lazy"></p> <h1 id="-the-end">👋 The end</h1> <p>All those who have read the blog post until here deserve a big round of applause. Hope y’all have learned something new from this blog post</p> <p><img src="https://ik.imagekit.io/genicsblog/tr:f-webp/https://c.tenor.com/Sq7rY9NKKd4AAAAC/oscars-standing-ovation.gif" alt="" loading="lazy"></p> <h2 id="-links">🔗 Links</h2> <ul> <li><a href="https://github.com/Kira272921/thw-faucet-cli" rel="nofollow noopener noreferrer" target="_blank">GitHub</a></li> <li><a href="https://www.npmjs.com/package/thw-faucet-cli" rel="nofollow noopener noreferrer" target="_blank">npmjs</a></li> <li><a href="https://thw-faucet-cli.vercel.app" rel="nofollow noopener noreferrer" target="_blank">Website</a></li> <li><a href="https://thw-faucet-cli-production.up.railway.app" rel="nofollow noopener noreferrer" target="_blank">Backend</a></li> </ul> <p>~ Happy building!</p> </article> <hr> <div class="px-6 pb-6 md:px-8 md:pb-8 flex flex-col items-center rounded-bl-2xl rounded-br-2xl"> <p class="text-center mb-4"> Join discussions at <a href="https://discord.genicsblog.com" target="_blank" class="cta-link"> our discord server &gt; </a> <br> Did you learn something new? Add a comment below and spread the word! </p> <div class="grid grid-flow-col gap-6"> <a class="underline-none hover:scale-125 transition flex items-center" rel="nofollow noopener noreferrer" href="https://facebook.com/sharer.php?u=https://genicsblog.com/kira/how-to-build-a-faucet-cli-using-node-js" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;" target="_blank"> <img src="/assets/images/social/facebook.svg" class="social-image w-8 h-8" loading="lazy"> </a> <a class="underline-none hover:scale-125 transition flex items-center" rel="nofollow noopener noreferrer" href="https://api.whatsapp.com/send?text=Checkout%20this%20amazing%20article%20at%20Genics%20Blog%20'How%20to%20build%20a%20faucet%20CLI%20using%20NodeJS%20%F0%9F%9A%80':%20https://genicsblog.com/kira/how-to-build-a-faucet-cli-using-node-js" onclick="window.open(this.href, 'whatsapp-share', 'width=550,height=435');return false;" target="_blank"> <img src="/assets/images/social/whatsapp.svg" class="social-image w-10 h-10" loading="lazy"> </a> <a class="underline-none hover:scale-125 transition flex items-center" rel="nofollow noopener noreferrer" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://genicsblog.com/kira/how-to-build-a-faucet-cli-using-node-js" onclick="window.open(this.href, 'linkedin-share', 'width=550,height=435');return false;" target="_blank"> <img src="/assets/images/social/linkedin.svg" class="social-image w-7 h-7" loading="lazy"> </a> <a class="underline-none hover:scale-125 transition flex items-center" rel="nofollow noopener noreferrer" href="https://twitter.com/intent/tweet?text=Check%20out%20this%20amazing%20article%20by%20@kira_272921%20at%20@genicsblog:%20How%20to%20build%20a%20faucet%20CLI%20using%20NodeJS%20%F0%9F%9A%80&amp;url=https://genicsblog.com/kira/how-to-build-a-faucet-cli-using-node-js" onclick="window.open(this.href, 'twitter-share', 'width=550,height=435');return false;" target="_blank"> <img src="/assets/images/social/twitter.svg" class="social-image w-8 h-8" loading="lazy"> </a> <a class="underline-none hover:scale-125 transition flex items-center" rel="nofollow noopener noreferrer" href="https://www.snapchat.com/scan?attachmentUrl=https://genicsblog.com/kira/how-to-build-a-faucet-cli-using-node-js" onclick="window.open(this.href, 'snapchat-share', 'width=550,height=435');return false;" target="_blank"> <img src="/assets/images/social/snapchat.svg" class="social-image w-14 h-14 -m-2" loading="lazy"> </a> </div> </div> </div> </div> <aside class="m-6 md:m-10 lg:my-14 lg:mr-10 lg:-ml-4 md:mr-8 lg:max-w-[25%] xl:max-w-[20%]"> <figure class="p-6 md:p-8 elevated"> <img class="w-24 h-24 rounded-full mx-auto" src="https://ik.imagekit.io/genicsblog/tr:w-128,h-128,f-webp/https://avatars.githubusercontent.com/u/90365542?v=4" alt="Kira" loading="lazy"> <div class="pt-4 space-y-4"> <figcaption class="font-medium text-center"> <div> <a href="/author/kira/" class="text-xl font-bold"> Kira </a> </div> <div class="text-slate-700 dark:text-slate-200 text-sm"> Full stack web developer, open-source enthusiast and tech blogger </div> </figcaption> <p class="leading-5 font-medium text-justify">Hey 👋, I am Kira, a full stack web developer, open-source enthusiast and tech blogger</p> </div> </figure> <figure class="bg-white dark:bg-background rounded-2xl p-6 shadow-xl shadow-slate-200 dark:shadow-none mt-8 aspect-square w-full"> <div align="center"> <ins class="adsbygoogle" style="display: block" data-ad-format="auto" data-full-width-responsive="true" data-ad-client="ca-pub-8114751086331659" data-ad-slot="8698895132"></ins> <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script> </div> </figure> <figure class="px-6 pb-6 md:px-8 mt-8 elevated lg:sticky lg:top-24"> <img src="https://dash.beyondwords.io/logo-dark.svg" class="w-full aspect-video hidden dark:block" loading="lazy"> <img src="https://dash.beyondwords.io/logo.svg" class="w-full aspect-video dark:hidden" loading="lazy"> <h4> BeyondWords <span class="text-xs text-white px-3 py-1 align-middle rounded-xl bg-primary">Sponsored</span> </h4> <p>BeyondWords is an AI voice and audio publishing platform that brings frictionless audio to writers, newsrooms, and businesses!</p> <div class="flex justify-center"> <a class="px-3 py-1 mt-4 linkbtn underline-none" href="https://beyondwords.io?utm_source=genicsblog.com&amp;utm_medium=cpc&amp;utm_campaign=advertisement" rel="nofollow" target="_blank"> Check it out &gt; </a> </div> </figure> </aside> </section> <div class="flex justify-center mx-6 md:mx-10 lg:mx-14"> <div class="p-8 md:p-12 grid grid-flow-row sm:grid-flow-col gap-x-8 items-center justify-between elevated"> <section class="md:mr-4"> <h3>Contribute to the Genics Blog!</h3> <p> Genics Blog is a purely <a href="https://github.com/genicsblog" rel="nofollow noreferrer noopener" target="_blank" class="cta-link">open source</a> publication. Authors at Genics post highly resourceful content on varied topics relevant to the developer community. Join us and start publishing today! </p> </section> <a class="px-4 py-1.5 mt-8 md:mt-0 md:ml-4 linkbtn underline-none font-bold text-lg" href="/contribute"> Contribute </a> </div> </div> <br> <div align="center"> <ins class="adsbygoogle" style="display: block" data-ad-format="fluid" data-ad-layout-key="-fb+5w+4e-db+86" data-ad-client="ca-pub-8114751086331659" data-ad-slot="3535897708"></ins> <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script> </div> <br> <h1 class="mx-8 mt-12 md:mx-10 lg:mx-14 -mb-4 lg:-mb-8">Comments</h1> <section class="flex flex-col-reverse lg:flex-row"> <div id="comments" class="md:text-lg m-8 md:m-10 lg:m-14 lg:w-full lg:max-w-[65%] xl:max-w-[70%]"></div> <aside class="m-8 md:m-10 lg:my-14 lg:mr-10 lg:-ml-4 md:mr-8 lg:max-w-[25%] xl:max-w-[20%]"> <div class="p-6 md:p-8 space-y-4 lg:sticky lg:top-24 rounded-2xl bg-white dark:bg-background shadow-xl dark:shadow-none shadow-slate-200"> <p class="leading-5 font-medium text-justify"> Please adhere to our <a href="/code-of-conduct">Code of Conduct</a> while adding a comment. Respect other's opinion. </p> </div> </aside> </section> <div class="m-8 md:m-10 lg:m-14"> <div class="flex justify-center"> <h2>Related content</h2> </div> <div class="flex flex-col sm:grid sm:grid-cols-2 lg:grid-cols-3 sm:gap-4 md:gap-4 lg:gap-6 text-center"> <a class="mt-4 mb-6 px-6 pt-2 pb-6 postbox hover:border-web3 dark:hover:!border-web3 underline-none" href="/kira/solidity-quickstart-0"> <img src="https://ik.imagekit.io/genicsblog/tr:w-1920,h-1080,f-webp/https://user-images.githubusercontent.com/46792249/156168666-85804b30-d9db-4d0e-9433-4a668d42f65c.png" alt="Solidity Quickstart [0]" title="Solidity Quickstart [0]" class="aspect-video w-full mt-4" loading="lazy"> <div class="mt-6 mb-16"> <h2 class="line-clamp-2">Solidity Quickstart [0]</h2> <p class="line-clamp-3">Get started with your web3 journey by learning the solidity language, used to create smart contracts on the blockchain 🚀</p> </div> <div class="absolute mt-20 right-6 bottom-6 left-6"> <div class="flex items-center justify-between mt-6"> <div class="flex items-center"> <img src="https://ik.imagekit.io/genicsblog/tr:w-128,h-128,f-webp/https://avatars.githubusercontent.com/u/90365542?v=4" alt="Kira's Profile Picture" title="Kira's Profile Picture" class="rounded-full w-10 h-10" width="40px" height="40px" loading="lazy"> <span class="ml-2">Kira</span> </div> <span>Feb 27, 2022</span> </div> </div> </a> <a class="mt-4 mb-6 px-6 pt-2 pb-6 postbox hover:border-backend dark:hover:!border-backend underline-none" href="/dhruva/intro-to-graphql-with-node-and-typescript"> <img src="https://ik.imagekit.io/genicsblog/tr:w-1920,h-1080,f-webp/https://user-images.githubusercontent.com/46792249/151178959-781d2ea4-a4dc-4f89-90d9-b98d62821944.png" alt="Intro to GraphQL with Node.js and TypeScript" title="Intro to GraphQL with Node.js and TypeScript" class="aspect-video w-full mt-4" loading="lazy"> <div class="mt-6 mb-16"> <h2 class="line-clamp-2">Intro to GraphQL with Node.js and TypeScript</h2> <p class="line-clamp-3">The complete guide to working with GraphQL using TypeGraphQL and building a basic CRUD functionality with TypeORM and Postgres.</p> </div> <div class="absolute mt-20 right-6 bottom-6 left-6"> <div class="flex items-center justify-between mt-6"> <div class="flex items-center"> <img src="https://ik.imagekit.io/genicsblog/tr:w-128,h-128,f-webp/https://avatars.githubusercontent.com/u/66675022" alt="Dhruva Srinivas's Profile Picture" title="Dhruva Srinivas's Profile Picture" class="rounded-full w-10 h-10" width="40px" height="40px" loading="lazy"> <span class="ml-2">Dhruva</span> </div> <span>Jan 26, 2022</span> </div> </div> </a> <a class="mt-4 mb-6 px-6 pt-2 pb-6 postbox hover:border-web3 dark:hover:!border-web3 underline-none" href="/6-free-websites-to-learn-web3"> <img src="https://ik.imagekit.io/genicsblog/tr:w-1920,h-1080,f-webp/https://user-images.githubusercontent.com/76763565/150826259-e68d86cd-1164-4d6c-98d7-0e2251874f3e.png" alt="6 Free websites to learn Web 3.0" title="6 Free websites to learn Web 3.0" class="aspect-video w-full mt-4" loading="lazy"> <div class="mt-6 mb-16"> <h2 class="line-clamp-2">6 Free websites to learn Web 3.0</h2> <p class="line-clamp-3">An awesome list of 6 free websites to learn Web 3.0 development.</p> </div> <div class="absolute mt-20 right-6 bottom-6 left-6"> <div class="flex items-center justify-between mt-6"> <div class="flex items-center"> <img src="https://ik.imagekit.io/genicsblog/tr:w-128,h-128,f-webp/https://avatars.githubusercontent.com/u/76763565" alt="Aditya Singh's Profile Picture" title="Aditya Singh's Profile Picture" class="rounded-full w-10 h-10" width="40px" height="40px" loading="lazy"> <span class="ml-2">Aditya</span> </div> <span>Jan 25, 2022</span> </div> </div> </a> </div> </div> <br> <div align="center"> <ins class="adsbygoogle" style="display: block" data-ad-format="fluid" data-ad-layout-key="-fb+5w+4e-db+86" data-ad-client="ca-pub-8114751086331659" data-ad-slot="3535897708"></ins> <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script> </div> <br> </main> <footer class="px-12 py-8 text-center"> <div class="flex justify-center"> <a aria-label="Genics Blog's Discord server" class="mr-2 underline-none hover:scale-125 transition" href="https://discord.genicsblog.com" target="_blank"> <img alt="Discord's logo" src="/assets/images/social/discord.svg" class="social-image w-8 h-8" loading="lazy"> </a> <a aria-label="Genics Blog's GitHub organization" class="mx-4 underline-none hover:scale-125 transition" href="https://github.com/genicsblog" target="_blank" rel="nofollow noopener noreferrer"> <img alt="GitHub's logo" src="/assets/images/social/github.svg" class="social-image w-8 h-8" loading="lazy"> </a> <a aria-label="Genics Blog's Twitter page" class="ml-2 underline-none hover:scale-125 transition" href="https://twitter.com/genicsblog" target="_blank" rel="nofollow noopener noreferrer"> <img alt="Twitter's logo" src="/assets/images/social/twitter.svg" class="social-image w-8 h-8" loading="lazy"> </a> </div> <br> © 2021 <a href="/">Genics Blog</a> <br> Built with <a href="https://jekyllrb.com" target="_blank" rel="nofollow noopener noreferrer">Jekyll</a>. Hosted on <a href="https://github.com" target="_blank" rel="nofollow noopener noreferrer">GitHub</a>. <br><br> Developed by <a href="https://github.com/gouravkhunger" rel="nofollow noopener noreferrer" target="_blank"> Gourav Khunger</a>. Thanks to the <a href="https://github.com/genicsblog/genicsblog.com/graphs/contributors" rel="nofollow noopener noreferrer" target="_blank"> contributors</a>! <br><br> <a class="nav-item text-white" href="/terms">T&amp;C</a> <a class="nav-item text-white" href="/privacy-policy">Privacy Policy</a> <a class="nav-item text-white" href="/licensing">Licensing</a> </footer> <div class="hidden fixed top-0 w-full h-full p-6 md:p-14 backdrop-blur-md cursor-pointer z-20" id="search-container"> <div class="p-4 bg-white dark:bg-slate-800 mx-auto w-full max-h-full sm:w-3/4 lg:w-1/2 content-center rounded-lg shadow-md shadow-slate-200 dark:shadow-none cursor-auto overflow-auto" id="search-box"> <div class="flex items-center"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 stroke-slate-400" fill="none" viewbox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path> </svg> <input type="text" class="w-full h-full pl-4 text-2xl outline-none dark:bg-slate-800" id="search-input" placeholder="Search..."> <span class="hidden lg:block text-sm text-gray-600 text-right tracking-tight ml-2"> <kbd class="bg-gray-200 dark:bg-slate-600 dark:text-gray-200 rounded-md shadow-sm py-1 px-2">Esc</kbd> </span> </div> <div id="results-container"></div> </div> </div> <script src="/assets/js/theme.js" data-no-instant></script> <script src="/assets/js/search.js" data-no-instant></script> <script src="/assets/js/prism.js" data-no-instant></script> <script src="/assets/js/instantclick.min.js" data-no-instant></script> <script data-no-instant>InstantClick.on("change",()=>{setTheme(),Prism.highlightAll(),initCodeBlocks(),window.onscroll=(()=>{setStickyness()}),document.getElementById("search-container").addEventListener("click",e=>{"search-container"===e.target.id&&hideSearch()});const e=window.location.pathname+window.location.search+window.location.hash;gtag("set","page_path",e),window.BwPlayer&&"function"==typeof window.BwPlayer.pause&&window.BwPlayer.pause();const n=document.getElementById("audio-player");if(n){const e=document.createElement("script");e.type="module",e.text=`import BeyondWords from 'https://proxy.beyondwords.io/npm/@beyondwords/audio-player@latest/dist/module/index.js'\n\n      BeyondWords.sdk.player({\n        renderNode: 'audio-player',\n        projectId: 11987,\n        podcastId: ${n.dataset.audioId},\n      }).then(appInst => {\n        window.BwPlayer = appInst;\n        const player = document.getElementsByClassName("sk-app-container")[0];\n        player.classList.add("rounded-xl");\n        const attribution = document.getElementsByClassName("sk-app-link")[0];\n        attribution.classList.add("underline-none");\n      });`,document.body.appendChild(e)}const t=document.getElementById("comments");if(t){const e={src:"https://giscus.app/client.js","data-repo":"genicsblog/comments","data-repo-id":"R_kgDOG0-Vlw","data-category":"Announcements","data-category-id":"DIC_kwDOG0-Vl84CP8Dz","data-mapping":"pathname","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":`${isDark()?GISCUS_DARK:GISCUS_LIGHT}`,"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},n=document.createElement("script");for(key in e)n.setAttribute(key,e[key]);t.appendChild(n)}}),InstantClick.on("receive",()=>{"function"==typeof window.cleanup&&(window.cleanup(),window.cleanup())}),InstantClick.init("mousedown");</script> </body> </html>